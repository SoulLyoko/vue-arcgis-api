(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./node_modules/@arcgis/core/geometry/geometryAdapters/json.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return t}));const t={convertToGEGeometry:function s(t,s){return null==s?null:t.convertJSONToGeometry(s)},exportPoint:function n(t,s,n){const e=new i(t.getPointX(s),t.getPointY(s),n),o=t.hasZ(s),h=t.hasM(s);return o&&(e.z=t.getPointZ(s)),h&&(e.m=t.getPointM(s)),e},exportPolygon:function o(t,s,i){return new e(t.exportPaths(s),i,t.hasZ(s),t.hasM(s))},exportPolyline:function a(t,s,i){return new h(t.exportPaths(s),i,t.hasZ(s),t.hasM(s))},exportMultipoint:function c(t,s,i){return new r(t.exportPoints(s),i,t.hasZ(s),t.hasM(s))},exportExtent:function m(t,s,i){const n=t.hasZ(s),e=t.hasM(s),o=new x(t.getXMin(s),t.getYMin(s),t.getXMax(s),t.getYMax(s),i);if(n){const i=t.getZExtent(s);o.zmin=i.vmin,o.zmax=i.vmax}if(e){const i=t.getMExtent(s);o.mmin=i.vmin,o.mmax=i.vmax}return o}};class i{constructor(t,s,i){this.x=t,this.y=s,this.spatialReference=i,this.z=void 0,this.m=void 0}}class e{constructor(t,s,i,n){this.rings=t,this.spatialReference=s,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class h{constructor(t,s,i,n){this.paths=t,this.spatialReference=s,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class r{constructor(t,s,i,n){this.points=t,this.spatialReference=s,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class x{constructor(t,s,i,n,e){this.xmin=t,this.ymin=s,this.xmax=i,this.ymax=n,this.spatialReference=e,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},"./node_modules/@arcgis/core/layers/graphics/centroid.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return e}));var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js");function n(t,n){return t?n?4:3:n?3:2}function e(e,o,u,l,N){if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(o)||!o.lengths.length)return null;const s="upperLeft"===(null==N?void 0:N.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,f=[],i=u?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:T,coords:h}=o,g=n(u,l);let E=0;for(const t of T){const n=r(i,h,E,t,u,l,s);n&&f.push(n),E+=t*g}if(f.sort(((t,n)=>{let e=s*t[2]-s*n[2];return 0===e&&u&&(e=t[4]-n[4]),e})),f.length){let t=6*f[0][2];c[0]=f[0][0]/t,c[1]=f[0][1]/t,u&&(t=6*f[0][4],c[2]=0!==t?f[0][3]/t:0),(c[0]<i[0]||c[0]>i[1]||c[1]<i[2]||c[1]>i[3]||u&&(c[2]<i[4]||c[2]>i[5]))&&(c.length=0)}if(!c.length){const t=o.lengths[0]?I(h,0,T[0],u,l):null;if(!t)return null;c[0]=t[0],c[1]=t[1],u&&t.length>2&&(c[2]=t[2])}return e}function r(t,e,r,I,o,u,l=1){const N=n(o,u);let s=r,c=r+N,f=0,i=0,T=0,h=0,g=0;for(let n=0,m=I-1;n<m;n++,s+=N,c+=N){const n=e[s],r=e[s+1],I=e[s+2],u=e[c],l=e[c+1],N=e[c+2];let E=n*l-u*r;h+=E,f+=(n+u)*E,i+=(r+l)*E,o&&(E=n*N-u*I,T+=(I+N)*E,g+=E),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),o&&(I<t[4]&&(t[4]=I),I>t[5]&&(t[5]=I))}if(h*l>0&&(h*=-1),g*l>0&&(g*=-1),!h)return null;const E=[f,i,.5*h];return o&&(E[3]=T,E[4]=.5*g),E}function I(t,e,r,I,s){const c=n(I,s);let f=e,i=e+c,T=0,h=0,g=0,E=0;for(let n=0,m=r-1;n<m;n++,f+=c,i+=c){const n=t[f],e=t[f+1],r=t[f+2],s=t[i],c=t[i+1],m=t[i+2],b=I?u(n,e,r,s,c,m):o(n,e,s,c);if(b)if(T+=b,I){const t=N(n,e,r,s,c,m);h+=b*t[0],g+=b*t[1],E+=b*t[2]}else{const t=l(n,e,s,c);h+=b*t[0],g+=b*t[1]}}return T>0?I?[h/T,g/T,E/T]:[h/T,g/T]:r>0?I?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function o(t,n,e,r){const I=e-t,o=r-n;return Math.sqrt(I*I+o*o)}function u(t,n,e,r,I,o){const u=r-t,l=I-n,N=o-e;return Math.sqrt(u*u+l*l+N*N)}function l(t,n,e,r){return[t+.5*(e-t),n+.5*(r-n)]}function N(t,n,e,r,I,o){return[t+.5*(r-t),n+.5*(I-n),e+.5*(o-e)]}},"./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return QueryEngine_L}));var Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),MemCache=__webpack_require__("./node_modules/@arcgis/core/core/MemCache.js"),unitUtils=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),aaBoundingBox=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),boundsUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/boundsUtils.js"),jsonUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js"),normalizeUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/normalizeUtils.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),ItemCache=__webpack_require__("./node_modules/@arcgis/core/core/ItemCache.js"),WhereClause=__webpack_require__("./node_modules/@arcgis/core/core/sql/WhereClause.js");const attributeSupport_s=new class WhereClauseCache_c{constructor(e,c){this._cache=new ItemCache.a(e),this._invalidCache=new ItemCache.a(c)}get(t,c){const i=`${c.uid}:${t}`,r=this._cache.get(i);if(r)return r;if(void 0!==this._invalidCache.get(i))return null;try{const r=WhereClause.WhereClause.create(t,c);return this._cache.put(i,r),r}catch{return this._invalidCache.put(i,null),null}}}(50,500),attributeSupport_n="feature-store:unsupported-query",attributeSupport_r=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function attributeSupport_l(e,i){return e?attributeSupport_s.get(e,i):null}function attributeSupport_c(i,s,t,r=!0){const o=[];for(const u of s)if("*"!==u&&!i.has(u))if(r){const s=attributeSupport_d(u);try{const t=attributeSupport_l(s,i);if(!t)throw new Error.a(attributeSupport_n,"invalid SQL expression",{where:s});if(!t.isStandardized)throw new Error.a(attributeSupport_n,"expression is not standard",{clause:t});attributeSupport_c(i,t.fieldNames,"expression contains missing fields")}catch(a){const e=a&&a.details;if(e&&(e.clause||e.where))throw a;e&&e.missingFields?o.push(...e.missingFields):o.push(u)}}else o.push(u);if(o.length)throw new Error.a(attributeSupport_n,t,{missingFields:o})}function attributeSupport_d(e){return e.split(" as ")[0]}function attributeSupport_f(e,i){const s=i.get(e);return!!s&&!attributeSupport_r.has(s.type)}var projectionSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js"),QueryEngineCapabilities=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js"),quantizationUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/quantizationUtils.js"),featureConversionUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js"),utils=__webpack_require__("./node_modules/@arcgis/core/statistics/utils.js");class AttributesBuilder_r{constructor(t,a,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=a;const l=t.outFields;if(l&&-1===l.indexOf("*")){this.outFields=l;let t=0;for(const a of l){const l=attributeSupport_d(a),u=this.fieldsIndex.get(l),n=u?null:attributeSupport_l(l,r),c=u?u.name:a.split(" as ")[1]||"FIELD_EXP_"+t++;this._fieldDataCache.set(a,{alias:c,clause:n})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,i){const a=i?i.name:e;let r=null;return this._fieldDataCache.has(a)?r=this._fieldDataCache.get(a).clause:i||(r=attributeSupport_l(e,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:r})),i?this.featureAdapter.getAttribute(t,a):r.calculateValue(t,this.featureAdapter)}getNormalizedValue(t,e){const s=e.normalizationType,i=e.normalizationTotal;let r=this.getFieldValue(t,e.field,e.fieldInfo);if(s&&Number.isFinite(r)){const l=this.getFieldValue(t,e.normalizationField,e.normalizationFieldInfo);r=Object(utils.i)(r,s,l,i)}return r}getExpressionValue(t,e,s){const i={attributes:this.featureAdapter.getAttributes(t)},a=s.createExecContext(i,e.viewInfo);return s.executeFunction(e.compiledFunc,a)}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:attributeSupport_l(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testFeature(t,this.featureAdapter)}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:attributeSupport_l(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const s={};for(const i of e){const{alias:e,clause:a}=this._fieldDataCache.get(i);s[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return s}_processAttributesForDistinctValues(e){if(Object(maybe.k)(e)||!this.returnDistinctValues)return e;const s=this.outFields,i=[];if(s)for(const t of s){const{alias:s}=this._fieldDataCache.get(t);i.push(e[s])}else for(const t in e)i.push(e[t]);const a=`${(s||["*"]).join(",")}=${i.join(",")}`;let r=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++r),r>1?null:e}}var timeSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/timeSupport.js"),data_utils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/utils.js"),fieldUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),arcadeOnDemand=__webpack_require__("./node_modules/@arcgis/core/support/arcadeOnDemand.js");class QueryEngineResult_S{constructor(e,t,i){this.items=e,this.queryGeometry=t,this.definitionExpression=i.definitionExpression,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.fieldsIndex=i.fieldsIndex,this.timeInfo=i.timeInfo,this.featureAdapter=i.featureAdapter,this.aggregateAdapter=i.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new AttributesBuilder_r(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:s}=e;if(!(null==i?void 0:i.length))return 1;const a=new Map,r=new Map,o=new Set,l=e.outStatistics;for(const n of l){const{statisticType:e}=n,l="exceedslimit"!==e?n.onStatisticField:void 0;if(!r.has(l)){const e=[];for(const s of i){const i=this._getAttributeValues(t,s,a);e.push(i)}r.set(l,this._calculateUniqueValues(e,t.returnDistinctValues))}const u=r.get(l);for(const i in u){const{data:e,items:a}=u[i],r=e.join(",");s&&!t.validateItems(a,s)||o.add(r)}}return o.size}createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(spatialReferenceUtils.l)(e.outSR)&&!Object(spatialReferenceUtils.d)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(data_utils.b)({spatialReference:e.outSR,...Object(projectionSupport.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=Object(data_utils.b)({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(t,i){const s=this.featureAdapter,a=function R(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:r,y:n}=t.point,o="number"==typeof t.distance?t.distance:t.distance.x,l="number"==typeof t.distance?t.distance:t.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,d=this.getPointCreator(t.point,this.spatialReference,i);for(const m of this.items){const i=s.getGeometry(m);if(Object(maybe.k)(i))continue;const{coords:h,lengths:f}=i;if(1&t.types){let e=0;for(let t=0;t<f.length;t++){const i=f[t];for(let t=0;t<i;t++,e+=a){const c=h[e],f=h[e+1];if(t!==i-1){const t=h[e+a],i=h[e+a+1],{x:p,y:y}=QueryEngineResult_(r,n,c,f,t,i),g=(r-p)/o,I=(n-y)/l,x=g*g+I*I;x<=1&&u.candidates.push({type:"edge",objectId:s.getObjectId(m),distance:Math.sqrt(x),target:d(p,y),start:d(c,f),end:d(t,i)})}}}}if(2&t.types){const e=c?h.length-a:h.length;for(let t=0;t<e;t+=a){const e=h[t],i=h[t+1],a=(r-e)/o,c=(n-i)/l,f=a*a+c*c;f<=1&&u.candidates.push({type:"vertex",objectId:s.getObjectId(m),distance:Math.sqrt(f),target:d(e,i)})}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}getPointCreator(e,i,s){const r=Object(maybe.l)(s)&&!Object(spatialReferenceUtils.d)(i,s)?e=>Object(projectionSupport.b)(e,i,s):e=>e;return null!=e.z&&null!=e.m?(t,i)=>r({x:t,y:i,z:e.z,m:e.m}):null!=e.z?(t,i)=>r({x:t,y:i,z:e.z}):null!=e.m?(t,i)=>r({x:t,y:i,m:e.m}):(e,t)=>r({x:e,y:t})}executeAttributesQuery(e){const t=attributeSupport_l(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let i=0;const s=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(s[i++]=e);const a=new QueryEngineResult_S(s,this.queryGeometry,this);return a.definitionExpression=e.where,Promise.resolve(a)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(maybe.k)(this.aggregateAdapter))return Promise.resolve(this);const i=new Set;for(const e of t.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(e).forEach((e=>i.add(e)));const s=this.featureAdapter.getObjectId;return Promise.resolve(new QueryEngineResult_S(this.items.filter((e=>i.has(s(e)))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),i=this.featureAdapter.getObjectId;return Promise.resolve(new QueryEngineResult_S(this.items.filter((e=>t.has(i(e)))),this.queryGeometry,this))}executeTimeQuery(e){const i=Object(timeSupport.b)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!Object(maybe.l)(i))return Promise.resolve(this);const s=this.items.filter(i);return Promise.resolve(new QueryEngineResult_S(s,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:i}=this.timeInfo,s=i||t,a=new Map,r=this.featureAdapter.getAttribute;for(const o of this.items){const t=r(o,e),i=r(o,s),n=a.get(t);(!n||i>r(n,s))&&a.set(t,o)}const n=Array.from(a.values());return Promise.resolve(new QueryEngineResult_S(n,this.queryGeometry,this))}async project(e){if(!e||Object(spatialReferenceUtils.d)(this.spatialReference,e))return this;const t=this.featureAdapter,i=(await Object(projectionSupport.c)(this.items.map((e=>Object(data_utils.c)(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e)))),this.spatialReference,e)).map(((e,i)=>t.cloneWithGeometry(this.items[i],Object(featureConversionUtils.d)(e,this.hasZ,this.hasM))));return new QueryEngineResult_S(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}async createSummaryStatisticsResponse(e,t){const{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,minValue:o,maxValue:l,scale:u}=t,c=this.fieldsIndex.isDateField(i),d=await this._getDataValues(e,{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,scale:u}),m=Object(utils.j)({normalizationType:r,normalizationField:a,minValue:o,maxValue:l}),h=this.fieldsIndex.get(i),x={value:.5,fieldType:null==h?void 0:h.type},T=Object(fieldUtils.q)(h)?Object(utils.e)({values:d,supportsNullCount:m,percentileParams:x}):Object(utils.d)({values:d,minValue:o,maxValue:l,useSampleStdDev:!r,supportsNullCount:m,percentileParams:x});return Object(utils.k)(T,c)}async createUniqueValuesResponse(e,t){const{field:i,valueExpression:s,domain:a,returnAllCodedValues:r,scale:n}=t,o=await this._getDataValues(e,{field:i,valueExpression:s,scale:n}),l=Object(utils.f)(o);return Object(utils.g)(l,a,r)}async createClassBreaksResponse(e,t){const{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numClasses:d,scale:m}=t,h=await this._getDataValues(e,{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,scale:m}),f=Object(utils.a)(h,{field:i,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numClasses:d});return Object(utils.l)(f,o)}async createHistogramResponse(e,t){const{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numBins:d,scale:m}=t,h=await this._getDataValues(e,{field:i,valueExpression:s,normalizationField:a,normalizationType:r,normalizationTotal:n,scale:m});return Object(utils.b)(h,{field:i,normalizationField:a,normalizationType:r,normalizationTotal:n,classificationMethod:o,standardDeviationInterval:l,minValue:u,maxValue:c,numBins:d})}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const s of t.reverse()){const t=s.split(" "),a=t[0],r=this.fieldsIndex.get(a),n=t[1]&&"desc"===t[1].toLowerCase(),o=Object(utils.h)(null==r?void 0:r.type,n);e.sort(((e,t)=>{const s=i(e,a,r),n=i(t,a,r);return o(s,n)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:s,hasM:a,hasZ:r,objectIdField:n,spatialReference:o}=this,{outFields:l,outSR:u,quantizationParameters:c,resultRecordCount:m,resultOffset:h,returnZ:f,returnM:p}=e,y=null!=m&&t.length>(h||0)+m,g=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:y,features:this._createFeatures(e,t),fields:g,geometryType:s,hasM:a&&p,hasZ:r&&f,objectIdFieldName:n,spatialReference:Object(data_utils.b)(u||o),transform:c&&Object(quantizationUtils.c)(c)||null}}_createFeatures(e,t){const s=new AttributesBuilder_r(e,this.featureAdapter,this.fieldsIndex),{hasM:a,hasZ:r}=this,{orderByFields:o,quantizationParameters:l,returnGeometry:u,returnCentroid:c,maxAllowableOffset:d,resultOffset:f,resultRecordCount:p,returnZ:y=!1,returnM:g=!1}=e,I=r&&y,x=a&&g;let T=[],V=0;const F=[...t];if(this._sortFeatures(F,o,((e,t,i)=>s.getFieldValue(e,t,i))),u||c){const e=Object(quantizationUtils.c)(l);if(u&&!c)for(const t of F)T[V++]={attributes:s.getAttributes(t),geometry:Object(data_utils.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),d,e,I,x)};else if(!u&&c)for(const t of F)T[V++]={attributes:s.getAttributes(t),centroid:Object(data_utils.f)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of F)T[V++]={attributes:s.getAttributes(t),centroid:Object(data_utils.f)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(data_utils.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),d,e,I,x)}}else for(const i of F){const e=s.getAttributes(i);e&&(T[V++]={attributes:e})}const b=f||0;if(null!=p){const e=b+p;T=T.slice(b,Math.min(T.length,e))}return T}_createExceedsLimitQueryResponse(e){let i=!1,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if("exceedslimit"===t.statisticType){s=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,a=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,r=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)i=this.items.length>s;else if(this.items.length>a)i=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,s=this.featureAdapter;i=this.items.reduce(((e,i)=>{const a=s.getGeometry(i);return e+(Object(maybe.l)(a)&&a.coords.length||0)}),0)/e>r}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(i)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},i=[],s=new Map,a=new Map,r=new Map,o=new Map,l=new AttributesBuilder_r(e,this.featureAdapter,this.fieldsIndex),u=e.outStatistics,{groupByFieldsForStatistics:c,having:d,orderByFields:m}=e,h=c&&c.length,f=!!h,p=f&&c[0],y=f&&!this.fieldsIndex.get(p);for(const n of u){const{outStatisticFieldName:e,statisticType:u}=n,m=n,g="exceedslimit"!==u?n.onStatisticField:void 0,I="percentile_disc"===u||"percentile_cont"===u,x=f&&1===h&&(g===p||y)&&"count"===u;if(f){if(!r.has(g)){const e=[];for(const t of c){const i=this._getAttributeValues(l,t,s);e.push(i)}r.set(g,this._calculateUniqueValues(e,l.returnDistinctValues))}const t=r.get(g);for(const i in t){const{count:a,data:r,items:n,itemPositions:u}=t[i],h=r.join(",");if(!d||l.validateItems(n,d)){const t=o.get(h)||{attributes:{}};let i=null;if(x)i=a;else{const e=this._getAttributeValues(l,g,s),t=u.map((t=>e[t]));i=I&&"statisticParameters"in m?this._getPercentileValue(m,t):this._getStatisticValue(m,t,null,l.returnDistinctValues)}t.attributes[e]=i,c.forEach(((e,i)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${i+1}`]=r[i])),o.set(h,t)}}}else{const i=this._getAttributeValues(l,g,s);t.attributes[e]=I&&"statisticParameters"in m?this._getPercentileValue(m,i):this._getStatisticValue(m,i,a,l.returnDistinctValues)}i.push({name:e,alias:e,type:"esriFieldTypeDouble"})}const g=f?Array.from(o.values()):[t];return this._sortFeatures(g,m,((e,t)=>e.attributes[t])),{fields:i,features:g}}_getStatisticValue(e,t,i,s){const{onStatisticField:a,statisticType:r}=e;let n=null;return n=null!=i&&i.has(a)?i.get(a):Object(fieldUtils.q)(this.fieldsIndex.get(a))?Object(utils.e)({values:t,returnDistinct:s}):Object(utils.d)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(a,n),n["var"===r?"variance":r]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:s,statisticType:a}=e,{value:r,orderBy:n}=s,o=this.fieldsIndex.get(i),l={value:r,orderBy:n,fieldType:null==o?void 0:o.type,isDiscrete:"percentile_disc"===a};return Object(utils.c)(t,l)}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const s=this.fieldsIndex.get(t),a=this.items.map((i=>e.getFieldValue(i,t,s)));return i.set(t,a),a}_getAttributeNormalizedValues(e,t){return this.items.map((i=>e.getNormalizedValue(i,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,i){const{arcadeUtils:s}=await Object(arcadeOnDemand.e)(),a=s.createFunction(t),r=i&&s.getViewInfo(i);return this.items.map((t=>e.getExpressionValue(t,{compiledFunc:a,viewInfo:r},s)))}_calculateUniqueValues(e,t){const i={},s=this.items,a=s.length;for(let r=0;r<a;r++){const a=s[r],n=[];for(const t of e)n.push(t[r]);const o=n.join(",");t?null==i[o]&&(i[o]={count:1,data:n,items:[a],itemPositions:[r]}):null==i[o]?i[o]={count:1,data:n,items:[a],itemPositions:[r]}:(i[o].count++,i[o].items.push(a),i[o].itemPositions.push(r))}return i}async _getDataValues(e,t){const i=new AttributesBuilder_r(e,this.featureAdapter,this.fieldsIndex),{valueExpression:s,field:a,normalizationField:r,normalizationType:o,normalizationTotal:l,scale:u}=t,c=s?{viewingMode:"map",scale:u,spatialReference:e.outSR||this.spatialReference}:null;return s?this._getAttributeExpressionValues(i,s,c):this._getAttributeNormalizedValues(i,{field:a,normalizationField:r,normalizationType:o,normalizationTotal:l})}}function QueryEngineResult_(e,t,i,s,a,r){const n=a-i,o=r-s,l=n*n+o*o,u=(e-i)*n+(t-s)*o,c=Math.min(1,Math.max(0,u/l));return{x:i+n*c,y:s+o*c}}var spatialQuerySupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js"),FieldsIndex=__webpack_require__("./node_modules/@arcgis/core/layers/support/FieldsIndex.js"),Scheduler=__webpack_require__("./node_modules/@arcgis/core/views/support/Scheduler.js");const N="feature-store:unsupported-query";const H=new Set,D=new MemCache.c(2e6);let J=0;class QueryEngine_L{constructor(e){this.capabilities={query:QueryEngineCapabilities.a},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new MemCache.b(J+++"$$",D)),this.fieldsIndex=new FieldsIndex.a(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=Object(maybe.t)(this._frameTask),this.clearCache(),Object(maybe.e)(this._geometryQueryCache),this._changeHandle=Object(maybe.t)(this._changeHandle),Object(maybe.e)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(data_utils.b)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(timeSupport.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e={},i){let s,r=Object(lang.a)(e);try{r=await this._schedule((()=>Object(data_utils.d)(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i)}catch(a){if(a!==data_utils.a)throw a;s=new QueryEngineResult_S([],null,this)}return s.createQueryResponse(r)}async executeQueryForCount(e={},i){let s=Object(lang.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule((()=>Object(data_utils.d)(s,this.definitionExpression,this.spatialReference)),i),s=await this._reschedule((()=>this._checkQuerySupport(s)),i);let e=await this._reschedule((()=>this._executeGeometryQuery(s,i)),i);return e=await this._reschedule((()=>e.executeAggregateIdsQuery(s)),i),e=await this._reschedule((()=>e.executeObjectIdsQuery(s)),i),e=await this._reschedule((()=>e.executeTimeQuery(s)),i),e=await this._reschedule((()=>e.executeAttributesQuery(s)),i),e.createQueryResponseForCount(s)}catch(r){if(r!==data_utils.a)throw r;return 0}}async executeQueryForExtent(e={},i){let s,r=Object(lang.a)(e);const a=r.outSR;try{r=await this._schedule((()=>Object(data_utils.d)(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),r.returnGeometry=!0,r.returnCentroid=!1,r.outSR=null,s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i);const e=s.size;if(!e)return{count:e,extent:null};Object(aaBoundingBox.B)($,aaBoundingBox.a),this.featureStore.forEachBounds(s.items,(e=>Object(aaBoundingBox.m)($,e)),QueryEngine_V);const t={xmin:$[0],ymin:$[1],xmax:$[3],ymax:$[4],spatialReference:Object(data_utils.b)(this.spatialReference)};this.hasZ&&isFinite($[2])&&isFinite($[5])&&(t.zmin=$[2],t.zmax=$[5]);const n=Object(projectionSupport.b)(t,s.spatialReference,a);if(n.spatialReference=Object(data_utils.b)(a||this.spatialReference),n.xmax-n.xmin==0){const e=Object(unitUtils.f)(n.spatialReference);n.xmin-=e,n.xmax+=e}if(n.ymax-n.ymin==0){const e=Object(unitUtils.f)(n.spatialReference);n.ymin-=e,n.ymax+=e}if(this.hasZ&&null!=n.zmin&&null!=n.zmax&&n.zmax-n.zmin==0){const e=Object(unitUtils.f)(n.spatialReference);n.zmin-=e,n.zmax+=e}return{count:e,extent:n}}catch(n){if(n===data_utils.a)return{count:0,extent:null};throw n}}async executeQueryForIds(e={},t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e={},i){let s,r=Object(lang.a)(e);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=await this._schedule((()=>Object(data_utils.d)(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i);const e=s.items,t=new Set;return await this._reschedule((()=>{for(const i of e)t.add(s.featureAdapter.getObjectId(i))}),i),t}catch(a){if(a===data_utils.a)return new Set;throw a}}async executeQueryForSnapping(e,t){const{point:i,distance:s,types:a}=e;if(0===a)return{candidates:[]};const n=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),u=!Object(spatialReferenceUtils.d)(i.spatialReference,this.spatialReference);u&&await Object(projectionSupport.a)(i.spatialReference,this.spatialReference);const o="number"==typeof s?s:s.x,c="number"==typeof s?s:s.y,h={xmin:i.x-o,xmax:i.x+o,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},l=u?Object(projectionSupport.b)(h,this.spatialReference):h;if(!l)return{candidates:[]};const p=(await Object(normalizeUtils.a)(Object(jsonUtils.a)(i),null,{signal:t}))[0],d=(await Object(normalizeUtils.a)(Object(jsonUtils.a)(l),null,{signal:t}))[0];if(Object(maybe.k)(p)||Object(maybe.k)(d))return{candidates:[]};let y=new QueryEngineResult_S(this._searchFeatures(this._getQueryBBoxes(d.toJSON())),null,this);y=await this._reschedule((()=>y.executeObjectIdsQuery(n)),t),y=await this._reschedule((()=>y.executeTimeQuery(n)),t),y=await this._reschedule((()=>y.executeAttributesQuery(n)),t);const m=p.toJSON(),f=u?Object(projectionSupport.b)(m,this.spatialReference):m,_=u?Math.max(l.xmax-l.xmin,l.ymax-l.ymin)/2:s;return y.createSnappingResponse({...e,point:f,distance:_},i.spatialReference)}async executeQueryForLatestObservations(i={},s){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new Error.a(N,"Missing timeInfo or timeInfo.trackIdField",{query:i,timeInfo:this.timeInfo});let r,a=Object(lang.a)(i);try{a=await this._schedule((()=>Object(data_utils.d)(a,this.definitionExpression,this.spatialReference)),s),a=await this._reschedule((()=>this._checkQuerySupport(a)),s),r=await this._reschedule((()=>this._executeGeometryQuery(a,s)),s),r=await this._reschedule((()=>r.executeAggregateIdsQuery(a)),s),r=await this._reschedule((()=>r.executeObjectIdsQuery(a)),s),r=await this._reschedule((()=>r.executeTimeQuery(a)),s),r=await this._reschedule((()=>r.executeAttributesQuery(a)),s),r=await this._reschedule((()=>r.filterLatest()),s)}catch(n){if(n!==data_utils.a)throw n;r=new QueryEngineResult_S([],null,this)}return r.createQueryResponse(a)}async executeQueryForSummaryStatistics(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createSummaryStatisticsResponse(e,t)}async executeQueryForUniqueValues(e={},t,i){const{field:s,valueExpression:r}=t;return(await this._getQueryEngineResultForStats(e,{field:s,valueExpression:r},i)).createUniqueValuesResponse(e,t)}async executeQueryForClassBreaks(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createClassBreaksResponse(e,t)}async executeQueryForHistogram(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createHistogramResponse(e,t)}async _schedule(e,t){return Object(maybe.l)(this._frameTask)?this._frameTask.schedule(e,t):e(Scheduler.d)}async _reschedule(e,t){return Object(maybe.l)(this._frameTask)?this._frameTask.reschedule(e,t):e(Scheduler.d)}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach((t=>e.push(t))),this._allItems=new QueryEngineResult_S(e,null,this)}return this._allItems}async _executeGeometryQuery(e,t){const{geometry:i,outSR:s,spatialRel:r,returnGeometry:a,returnCentroid:u}=e,o=a||u,c=Object(spatialReferenceUtils.l)(s)&&!Object(spatialReferenceUtils.d)(this.spatialReference,s),h=this._geometryQueryCache?c&&o?JSON.stringify({geometry:i,spatialRelationship:r,outSpatialReference:s}):JSON.stringify({geometry:i,spatialRelationship:r}):null;if(h){const e=this._geometryQueryCache.get(h);if(!Object(maybe.m)(e))return e}const l=async e=>{if(c&&o){const t=await e.project(s);return h&&this._geometryQueryCache.put(h,t,t.size||1),t}return h&&this._geometryQueryCache.put(h,e,e.size||1),e};if(!i)return l(this._getAll());const p=this.featureAdapter;if("esriSpatialRelDisjoint"===r){const e=this._searchFeatures(this._getQueryBBoxes(i));if(!e.length)return l(this._getAll());let s,a;const n=new Set;for(const t of e)n.add(p.getObjectId(t));await this._reschedule((()=>{let e=0;s=new Array(n.size),this.featureStore.forEach((t=>s[e++]=t)),a=n}),t);const u=await this._reschedule((async()=>{const e=await Object(spatialQuerySupport.c)(r,i,this.geometryType,this.hasZ,this.hasM);return new QueryEngineResult_S(await this._runSpatialFilter(s,(t=>!a.has(p.getObjectId(t))||e(p.getGeometry(t))),t),i,this)}),t);return l(u)}const d=this._searchFeatures(this._getQueryBBoxes(i));if(!d.length){const e=new QueryEngineResult_S([],i,this);return h&&this._geometryQueryCache.put(h,e,e.size||1),e}if(this._canExecuteSoloPass(i,e))return l(new QueryEngineResult_S(d,i,this));const y=await Object(spatialQuerySupport.c)(r,i,this.geometryType,this.hasZ,this.hasM),m=await this._runSpatialFilter(d,(e=>y(p.getGeometry(e))),t);return l(new QueryEngineResult_S(m,i,this))}async _runSpatialFilter(e,t,i){if(!t)return e;if(Object(maybe.k)(this._frameTask))return e.filter((e=>t(e)));let s=0;const a=new Array,n=async r=>{for(;s<e.length;){const u=e[s++];t(u)&&(a.push(u),r.madeProgress()),r.done&&await this._reschedule((e=>n(e)),i)}};return this._reschedule((e=>n(e)),i).then((()=>a))}_canExecuteSoloPass(e,t){const{geometryType:i}=this,{spatialRel:s}=t;return Object(spatialQuerySupport.a)(e)&&("esriSpatialRelEnvelopeIntersects"===s||"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===s||"esriSpatialRelContains"===s||"esriSpatialRelWithin"===s))}_getQueryBBoxes(e){if(Object(spatialQuerySupport.a)(e)){if(Object(jsonUtils.d)(e))return[Object(aaBoundingRect.t)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(jsonUtils.g)(e))return e.rings.map((e=>Object(aaBoundingRect.t)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[Object(boundsUtils.a)(Object(aaBoundingRect.l)(),e)]}_searchFeatures(e){for(const s of e)this.featureStore.forEachInBounds(s,(e=>{H.add(e)}));const t=new Array(H.size);let i=0;return H.forEach((e=>t[i++]=e)),H.clear(),t}async _checkStatisticsSupport(t,i){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new Error.a(N,"Unsupported query options",{query:t});return Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsParamsSupport(i),Object(spatialQuerySupport.b)(t,this.geometryType,this.spatialReference),Object(projectionSupport.a)(this.spatialReference,t.outSR)]).then((()=>t))}async _checkStatisticsParamsSupport(t){let i=[];if(t.valueExpression){const{arcadeUtils:e}=await Object(arcadeOnDemand.e)();i=e.extractFieldNames(t.valueExpression)}if(t.field&&i.push(t.field),t.normalizationField&&i.push(t.normalizationField),!i.length)throw new Error.a(N,"params should have at least a field or valueExpression",{params:t});attributeSupport_c(this.fieldsIndex,i,"params contains missing fields")}async _checkQuerySupport(t){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new Error.a(N,"Unsupported query options",{query:t});return Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(spatialQuerySupport.b)(t,this.geometryType,this.spatialReference),Object(projectionSupport.a)(this.spatialReference,t.outSR)]).then((()=>t))}_checkAttributesQuerySupport(t){const{outFields:i,orderByFields:s,returnDistinctValues:r,outStatistics:a}=t,n=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())):[];if(s&&s.length>0){const e=" asc",t=" desc",i=s.map((i=>{const s=i.toLowerCase();return s.indexOf(e)>-1?s.split(e)[0]:s.indexOf(t)>-1?s.split(t)[0]:i})).filter((e=>-1===n.indexOf(e)));attributeSupport_c(this.fieldsIndex,i,"orderByFields contains missing fields")}if(i&&i.length>0)attributeSupport_c(this.fieldsIndex,i,"outFields contains missing fields");else if(r)throw new Error.a(N,"outFields should be specified for returnDistinctValues",{query:t});!function attributeSupport_o(i,t){if(!t)return!0;const r=attributeSupport_s.get(t,i);if(!r)throw new Error.a(attributeSupport_n,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new Error.a(attributeSupport_n,"where clause is not standard",{where:t});return attributeSupport_c(i,r.fieldNames,"where clause contains missing fields"),!0}(this.fieldsIndex,t.where)}async _checkStatisticsQuerySupport(t){const{outStatistics:i,groupByFieldsForStatistics:s,having:r}=t,a=s&&s.length,n=i&&i.length;if(r){if(!a||!n)throw new Error.a(N,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});!function attributeSupport_a(i,t,r){if(!t)return!0;const o=attributeSupport_s.get(t,i);if(!o)throw new Error.a(attributeSupport_n,"invalid SQL expression",{having:t});if(!o.isAggregate)throw new Error.a(attributeSupport_n,"having does not contain a valid aggregate function",{having:t});const a=o.fieldNames;if(attributeSupport_c(i,a,"having contains missing fields"),!o.getExpressions().every((e=>{const{aggregateType:s,field:n}=e,t=i.has(n)&&i.get(n).name;return r.some((e=>{const{onStatisticField:n,statisticType:r}=e;return(i.has(n)&&i.get(n).name)===t&&r.toLowerCase().trim()===s}))})))throw new Error.a(attributeSupport_n,"expressions in having should also exist in outStatistics",{having:t});return!0}(this.fieldsIndex,r,i)}if(n){if(!function U(e){return e.every((e=>"exceedslimit"!==e.statisticType))}(i))return;const r=i.map((e=>e.onStatisticField));attributeSupport_c(this.fieldsIndex,r,"onStatisticFields contains missing fields"),a&&attributeSupport_c(this.fieldsIndex,s,"groupByFieldsForStatistics contains missing fields");for(const s of i){const{onStatisticField:i,statisticType:r}=s;if("percentile_disc"!==r&&"percentile_cont"!==r||!("statisticParameters"in s)){if("count"!==r&&i&&attributeSupport_f(i,this.fieldsIndex))throw new Error.a(N,"outStatistics contains non-numeric fields",{definition:s,query:t})}else{const{statisticParameters:i}=s;if(!i)throw new Error.a(N,"statisticParamters should be set for percentile type",{definition:s,query:t})}}}}async _getQueryEngineResultForStats(e={},i,s){let r;e=Object(lang.a)(e);try{e=await this._schedule((()=>Object(data_utils.d)(e,this.definitionExpression,this.spatialReference)),s),e=await this._reschedule((()=>this._checkStatisticsSupport(e,i)),s),r=await this._reschedule((()=>this._executeGeometryQuery(e,s)),s),r=await this._reschedule((()=>r.executeAggregateIdsQuery(e)),s),r=await this._reschedule((()=>r.executeObjectIdsQuery(e)),s),r=await this._reschedule((()=>r.executeTimeQuery(e)),s),r=await this._reschedule((()=>r.executeAttributesQuery(e)),s)}catch(a){if(a!==data_utils.a)throw a;r=new QueryEngineResult_S([],null,this)}return r}}const QueryEngine_V=Object(aaBoundingBox.h)(),$=Object(aaBoundingBox.h)()},"./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return t}));const t={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},"./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return f})),__webpack_require__.d(__webpack_exports__,"b",(function(){return g})),__webpack_require__.d(__webpack_exports__,"c",(function(){return M}));var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_geometry_projection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),_geometry_geometryAdapters_json_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/geometry/geometryAdapters/json.js"),_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js");const u=[0,0];function c(s,t){if(!t)return null;if("x"in t){const e={x:0,y:0};return[e.x,e.y]=s(t.x,t.y,u),null!=t.z&&(e.z=t.z),null!=t.m&&(e.m=t.m),e}if("xmin"in t){const e={xmin:0,ymin:0,xmax:0,ymax:0};return[e.xmin,e.ymin]=s(t.xmin,t.ymin,u),[e.xmax,e.ymax]=s(t.xmax,t.ymax,u),t.hasZ&&(e.zmin=t.zmin,e.zmax=t.zmax,e.hasZ=!0),t.hasM&&(e.mmin=t.mmin,e.mmax=t.mmax,e.hasM=!0),e}return"rings"in t?{rings:p(t.rings,s),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:p(t.paths,s),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:l(t.points,s),hasM:t.hasM,hasZ:t.hasZ}:void 0}function p(s,t){const e=[];for(const n of s)e.push(l(n,t));return e}function l(s,t){const e=[];for(const n of s){const s=t(n[0],n[1],[0,0]);e.push(s),n.length>2&&s.push(n[2]),n.length>3&&s.push(n[3])}return e}async function f(e,n){if(!n)return;const r=Array.isArray(e)?e.map((t=>Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(t.geometry)&&t.geometry.spatialReference)):[e];await Object(_geometry_projection_js__WEBPACK_IMPORTED_MODULE_1__.g)(r.map((s=>({source:s,dest:n}))))}const x=c.bind(null,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_4__.c),y=c.bind(null,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_4__.g);function g(s,t,m){return s?(m||(m=t,t=s.spatialReference),Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__.l)(t)&&Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__.l)(m)&&!Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__.d)(t,m)?Object(_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_4__.a)(t,m)?Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__.p)(m)?x(s):y(s):Object(_geometry_projection_js__WEBPACK_IMPORTED_MODULE_1__.r)(_geometry_geometryAdapters_json_js__WEBPACK_IMPORTED_MODULE_2__.a,[s],t,m,null)[0]:s):s}const j=new class _{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(s,t,e){if(!s||!s.length||!t||!e||Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__.d)(t,e))return s;const n={geometries:s,inSpatialReference:t,outSpatialReference:e,resolve:null};return this._jobs.push(n),new Promise((s=>{n.resolve=s,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const s=this._jobs.shift();if(!s)return;const{geometries:t,inSpatialReference:r,outSpatialReference:i,resolve:m}=s;Object(_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_4__.a)(r,i)?Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_3__.p)(i)?m(t.map(x)):m(t.map(y)):m(Object(_geometry_projection_js__WEBPACK_IMPORTED_MODULE_1__.r)(_geometry_geometryAdapters_json_js__WEBPACK_IMPORTED_MODULE_2__.a,t,r,i,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function M(s,t,e){return j.push(s,t,e)}},"./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return I})),__webpack_require__.d(__webpack_exports__,"b",(function(){return P})),__webpack_require__.d(__webpack_exports__,"c",(function(){return v}));var Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),contains=__webpack_require__("./node_modules/@arcgis/core/geometry/support/contains.js"),intersectsBase=__webpack_require__("./node_modules/@arcgis/core/geometry/support/intersectsBase.js");var jsonUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js");function contains_n(n,t){return n?t?4:3:t?3:2}function contains_o(t,r,o,c,u){if(!t)return!1;const f=contains_n(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=contains_e(l,s,f,d,n,c,u),d+=n*f;return l}function contains_e(n,t,r,o,e,c,u){let f=n,s=o;for(let i=o,l=o+e*r;i<l;i+=r){s=i+r,s===l&&(s=o);const n=t[i],e=t[i+1],d=t[s],g=t[s+1];(e<u&&g>=u||g<u&&e>=u)&&n+(u-e)/(g-e)*(d-n)<c&&(f=!f)}return f}var featureConversionUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js"),OptimizedGeometry=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js"),projectionSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js"),utils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/utils.js");const R={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},S_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},S_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},S_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function v(e,n,l,y,c){if(Object(jsonUtils.g)(n)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=Object(featureConversionUtils.g)(new OptimizedGeometry.a,n,!1,!1);return Promise.resolve((r=>function contains_t(n,t,r,e){return contains_o(n,t,r,e.coords[0],e.coords[1])}(e,!1,!1,r)))}if(Object(jsonUtils.g)(n)&&"esriGeometryMultipoint"===l){const r=Object(featureConversionUtils.g)(new OptimizedGeometry.a,n,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>function contains_r(t,r,e,c,u,f){const s=contains_n(u,f),{coords:i,lengths:l}=c;if(!l)return!1;for(let n=0,d=0;n<l.length;n++,d+=s)if(!contains_o(t,r,e,i[d],i[d+1]))return!1;return!0}(r,!1,!1,e,y,c)))}if(Object(jsonUtils.d)(n)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>Object(contains.e)(n,Object(utils.c)(l,y,c,e))));if(Object(jsonUtils.d)(n)&&"esriGeometryMultipoint"===l&&"esriSpatialRelContains"===e)return Promise.resolve((e=>Object(contains.d)(n,Object(utils.c)(l,y,c,e))));if(Object(jsonUtils.d)(n)&&"esriSpatialRelIntersects"===e){const e=function intersects_n(n){return"mesh"===n?intersectsBase.a:Object(intersectsBase.c)(n)}(l);return Promise.resolve((r=>e(n,Object(utils.c)(l,y,c,r))))}return function h(){return Promise.all([__webpack_require__.e(7),__webpack_require__.e(19)]).then(__webpack_require__.bind(null,"./node_modules/@arcgis/core/geometry/geometryEngineJSON.js"))}().then((r=>{const t=r[R[e]].bind(null,n.spatialReference,n);return e=>t(Object(utils.c)(l,y,c,e))}))}async function P(r,t,i){const{spatialRel:s,geometry:o}=r;if(o){if(!function G(e){return!0===S_spatialRelationship[e]}(s))throw new Error.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:r});if(Object(spatialReferenceUtils.l)(o.spatialReference)&&Object(spatialReferenceUtils.l)(i)){if(!function g(e){return!0===S_queryGeometry[Object(jsonUtils.c)(e)]}(o))throw new Error.a("feature-store:unsupported-query","Unsupported query geometry type",{query:r});if(!function j(e){return!0===S_layerGeometry[e]}(t))throw new Error.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:r});if(r.outSR)return Object(projectionSupport.a)(r.geometry&&r.geometry.spatialReference,r.outSR)}}}function I(e){if(Object(jsonUtils.d)(e))return!0;if(Object(jsonUtils.g)(e)){for(const r of e.rings){if(5!==r.length)return!1;if(r[0][0]!==r[1][0]||r[0][0]!==r[4][0]||r[2][0]!==r[3][0]||r[0][1]!==r[3][1]||r[0][1]!==r[4][1]||r[1][1]!==r[2][1])return!1}return!0}return!1}},"./node_modules/@arcgis/core/layers/graphics/data/timeSupport.js":function(module,__webpack_exports__,__webpack_require__){"use strict";function t(t,n){if(!t)return null;const e=n.featureAdapter,{startTimeField:u,endTimeField:l}=t;let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(u&&l)n.forEach((t=>{const n=e.getAttribute(t,u),o=e.getAttribute(t,l);null==n||isNaN(n)||(r=Math.min(r,n)),null==o||isNaN(o)||(i=Math.max(i,o))}));else{const t=u||l;n.forEach((n=>{const u=e.getAttribute(n,t);null==u||isNaN(u)||(r=Math.min(r,u),i=Math.max(i,u))}))}return{start:r,end:i}}function n(t,n,r){if(!n||!t)return null;const{startTimeField:i,endTimeField:o}=t;if(!i&&!o)return null;const{start:s,end:a}=n;return null===s&&null===a?null:void 0===s&&void 0===a?()=>!1:i&&o?function e(t,n,e,u,l){return null!=u&&null!=l?r=>{const i=t.getAttribute(r,n),o=t.getAttribute(r,e);return(null==i||i<=l)&&(null==o||o>=u)}:null!=u?n=>{const l=t.getAttribute(n,e);return null==l||l>=u}:null!=l?e=>{const u=t.getAttribute(e,n);return null==u||u<=l}:void 0}(r,i,o,s,a):function u(t,n,e,u){return null!=e&&null!=u&&e===u?u=>t.getAttribute(u,n)===e:null!=e&&null!=u?l=>{const r=t.getAttribute(l,n);return r>=e&&r<=u}:null!=e?u=>t.getAttribute(u,n)>=e:null!=u?e=>t.getAttribute(e,n)<=u:void 0}(r,i||o,s,a)}__webpack_require__.d(__webpack_exports__,"a",(function(){return t})),__webpack_require__.d(__webpack_exports__,"b",(function(){return n}))},"./node_modules/@arcgis/core/layers/graphics/data/utils.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return U})),__webpack_require__.d(__webpack_exports__,"b",(function(){return z})),__webpack_require__.d(__webpack_exports__,"c",(function(){return J})),__webpack_require__.d(__webpack_exports__,"d",(function(){return P})),__webpack_require__.d(__webpack_exports__,"e",(function(){return Z})),__webpack_require__.d(__webpack_exports__,"f",(function(){return O}));var _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),_geometry_support_extentUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/extentUtils.js"),_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js"),_geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/normalizeUtils.js"),_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__("./node_modules/@arcgis/core/layers/graphics/centroid.js"),__webpack_require__("./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js")),_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js"),_projectionSupport_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js");const j=new _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_0__.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),U=Object.freeze({}),M=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_9__.a,F=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_9__.a,G=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_9__.a,N={esriGeometryPoint:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.m,esriGeometryPolyline:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.o,esriGeometryPolygon:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.n,esriGeometryMultipoint:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.l};function O(e,r,i,o=e.hasZ,n=e.hasM){if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.k)(r))return null;const s=e.hasZ&&o,l=e.hasM&&n;if(i){const t=Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.u)(G,r,e.hasZ,e.hasM,"esriGeometryPoint",i,o,n);return Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(t,s,l)}return Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(r,s,l)}function J(e,i,o,n,s,l,a=i,m=o){const c=i&&a,f=o&&m,g=Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.l)(n)?"coords"in n?n:n.geometry:null;if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.k)(g))return null;if(s){let t=Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.q)(F,g,i,o,e,s,a,m);return l&&(t=Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.u)(G,t,c,f,e,l)),N[e](t,c,f)}if(l){const t=Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.u)(G,g,i,o,e,l,a,m);return N[e](t,c,f)}return Object(_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_8__.x)(M,g,i,o,a,m),N[e](M,c,f)}async function P(e,t,r){const{outFields:i,orderByFields:o,groupByFieldsForStatistics:n,outStatistics:s}=e;if(i)for(let l=0;l<i.length;l++)i[l]=i[l].trim();if(o)for(let l=0;l<o.length;l++)o[l]=o[l].trim();if(n)for(let l=0;l<n.length;l++)n[l]=n[l].trim();if(s)for(let l=0;l<s.length;l++)s[l].onStatisticField&&(s[l].onStatisticField=s[l].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),Z(e,t,r)}async function Z(e,r,i){if(!e)return null;let{where:l}=e;if(e.where=l=l&&l.trim(),(!l||/^1 *= *1$/.test(l)||r&&r===l)&&(e.where=null),!e.geometry)return e;let a=await async function b(e){const{geometry:t,distance:r,units:o}=e;if(null==r||"vertexAttributes"in t)return t;const n=t.spatialReference,s=o?j.fromJSON(o):Object(_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.h)(n),c=n&&(Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__.h)(n)||Object(_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__.p)(n))?t:await Object(_projectionSupport_js__WEBPACK_IMPORTED_MODULE_10__.a)(n,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__.b).then((()=>Object(_projectionSupport_js__WEBPACK_IMPORTED_MODULE_10__.b)(t,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__.b)));return(await async function x(){return(await Promise.all([__webpack_require__.e(7),__webpack_require__.e(19)]).then(__webpack_require__.bind(null,"./node_modules/@arcgis/core/geometry/geometryEngineJSON.js"))).geodesicBuffer}())(c.spatialReference,c,r,s)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;a=Object(_geometry_support_extentUtils_js__WEBPACK_IMPORTED_MODULE_3__.a)(a),a.spatialReference=t}e.geometry=a,await Object(_projectionSupport_js__WEBPACK_IMPORTED_MODULE_10__.a)(a.spatialReference,i);const m=(await Object(_geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_5__.a)(Object(_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__.a)(a)))[0];if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.k)(m))throw U;const c=m.toJSON(),u=await Object(_projectionSupport_js__WEBPACK_IMPORTED_MODULE_10__.b)(c,c.spatialReference,i);if(!u)throw U;return u.spatialReference=i,e.geometry=u,e}function z(e){return e&&B in e?JSON.parse(JSON.stringify(e,E)):e}const B="_geVersion",E=(e,t)=>e!==B?t:void 0},"./node_modules/@arcgis/core/rest/support/ClassBreaksDefinition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ClassBreaksDefinition_l}));var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),jsonMap=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),colorRamps=__webpack_require__("./node_modules/@arcgis/core/rest/support/colorRamps.js"),Symbol=__webpack_require__("./node_modules/@arcgis/core/symbols/Symbol.js");const c=new jsonMap.a({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});let l=class extends JSONSupport.a{constructor(){super(...arguments),this.baseSymbol=null,this.colorRamp=null,this.type=null}};Object(tslib_es6.a)([Object(property.b)({type:Symbol.a,json:{write:!0}})],l.prototype,"baseSymbol",void 0),Object(tslib_es6.a)([Object(property.b)({types:colorRamps.b,json:{read:{reader:colorRamps.a},write:!0}})],l.prototype,"colorRamp",void 0),Object(tslib_es6.a)([Object(property.b)({json:{read:c.read,write:c.write}})],l.prototype,"type",void 0),l=Object(tslib_es6.a)([Object(subclass.a)("esri.rest.support.ClassificationDefinition")],l);const m=l,o=new jsonMap.a({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),a=new jsonMap.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let n=class extends m{constructor(){super(...arguments),this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null,this.type="class-breaks-definition"}set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}};Object(tslib_es6.a)([Object(property.b)({json:{write:!0}})],n.prototype,"breakCount",void 0),Object(tslib_es6.a)([Object(property.b)({json:{write:!0}})],n.prototype,"classificationField",void 0),Object(tslib_es6.a)([Object(property.b)({type:String,json:{read:o.read,write:o.write}})],n.prototype,"classificationMethod",void 0),Object(tslib_es6.a)([Object(property.b)({json:{write:!0}})],n.prototype,"normalizationField",void 0),Object(tslib_es6.a)([Object(property.b)({json:{read:a.read,write:a.write}})],n.prototype,"normalizationType",void 0),Object(tslib_es6.a)([Object(property.b)({value:null,json:{write:!0}})],n.prototype,"standardDeviationInterval",null),Object(tslib_es6.a)([Object(property.b)({value:null,json:{write:!0}})],n.prototype,"definedInterval",null),Object(tslib_es6.a)([Object(property.b)()],n.prototype,"type",void 0),n=Object(tslib_es6.a)([Object(subclass.a)("esri.rest.support.ClassBreaksDefinition")],n);const ClassBreaksDefinition_l=n},"./node_modules/@arcgis/core/rest/support/generateRendererUtils.js":function(module,__webpack_exports__,__webpack_require__){"use strict";function e(e,l){return Number(e.toFixed(l))}function t(e){const{normalizationTotal:l}=e;return{classBreaks:n(e),normalizationTotal:l}}function n(l){const t=l.definition,{classificationMethod:n,breakCount:o,normalizationType:r,definedInterval:h}=t,m=[];let b=l.values;if(0===b.length)return[];b=b.sort(((e,l)=>e-l));const V=b[0],p=b[b.length-1];if("equal-interval"===n)if(b.length>=o){const l=(p-V)/o;let t=V;for(let n=1;n<o;n++){const u=e(V+n*l,6);m.push({minValue:t,maxValue:u,label:a(t,u,r)}),t=u}m.push({minValue:t,maxValue:p,label:a(t,p,r)})}else b.forEach((e=>{m.push({minValue:e,maxValue:e,label:a(e,e,r)})}));else if("natural-breaks"===n){const t=u(b),n=l.valueFrequency||t.valueFrequency,i=s(t.uniqueValues,n,o);let c=V;for(let l=1;l<o;l++)if(t.uniqueValues.length>l){const n=e(t.uniqueValues[i[l]],6);m.push({minValue:c,maxValue:n,label:a(c,n,r)}),c=n}m.push({minValue:c,maxValue:p,label:a(c,p,r)})}else if("quantile"===n)if(b.length>=o&&V!==p){let e=V,l=Math.ceil(b.length/o),t=0;for(let n=1;n<o;n++){let u=l+t-1;u>b.length&&(u=b.length-1),u<0&&(u=0),m.push({minValue:e,maxValue:b[u],label:a(e,b[u],r)}),e=b[u],t+=l,l=Math.ceil((b.length-t)/(o-n))}m.push({minValue:e,maxValue:p,label:a(e,p,r)})}else{let e=-1;for(let l=0;l<b.length;l++){const t=b[l];t!==e&&(e=t,m.push({minValue:e,maxValue:t,label:a(e,t,r)}),e=t)}}else if("standard-deviation"===n){const l=function c(e){let l=0;for(let t=0;t<e.length;t++)l+=e[t];return l/=e.length,l}(b),t=function f(e,l){let t=0;for(let n=0;n<e.length;n++){const a=e[n];t+=(a-l)*(a-l)}return t/=e.length,Math.sqrt(t)}(b,l);if(0===t)m.push({minValue:b[0],maxValue:b[0],label:a(b[0],b[0],r)});else{const n=function i(e,l,t,n,a){let u=Math.max(n-e,l-n)/a/t;return u=u>=1?1:u>=.5?.5:.25,u}(V,p,o,l,t)*t;let u=0,s=V;for(let t=o;t>=1;t--){const o=e(l-(t-.5)*n,6);m.push({minValue:s,maxValue:o,label:a(s,o,r)}),s=o,u++}let c=e(l+.5*n,6);m.push({minValue:s,maxValue:c,label:a(s,c,r)}),s=c,u++;for(let t=1;t<=o;t++)c=u===2*o?p:e(l+(t+.5)*n,6),m.push({minValue:s,maxValue:c,label:a(s,c,r)}),s=c,u++}}else if("defined-interval"===n){if(!h)return m;const l=b[0],t=b[b.length-1],n=Math.ceil((t-l)/h);let u=l;for(let s=1;s<n;s++){const t=e(l+s*h,6);m.push({minValue:u,maxValue:t,label:a(u,t,r)}),u=t}m.push({minValue:u,maxValue:t,label:a(u,t,r)})}return m}function a(e,l,t){let n=null;return n=e===l?t&&"percent-of-total"===t?e+"%":e.toString():t&&"percent-of-total"===t?e+"% - "+l+"%":e+" - "+l,n}function u(e){const l=[],t=[];let n=Number.MIN_VALUE,a=1,u=-1;for(let s=0;s<e.length;s++){const o=e[s];o===n?(a++,t[u]=a):null!==o&&(l.push(o),n=o,a=1,t.push(a),u++)}return{uniqueValues:l,valueFrequency:t}}function s(e,l,t){const n=e.length,a=[];t>n&&(t=n);for(let s=0;s<t;s++)a.push(Math.round(s*n/t-1));a.push(n-1);let u=o(a,e,l,t);return function r(e,l,t,n,a,u){let s=0,o=0,r=0,i=0,c=!0;for(let f=0;f<2&&c;f++){0===f&&(c=!1);for(let f=0;f<u-1;f++)for(;t[f+1]+1!==t[f+2];){t[f+1]=t[f+1]+1;const u=h(f,t,n,a);r=u.sbMean,s=u.sbSdcm;const m=h(f+1,t,n,a);if(i=m.sbMean,o=m.sbSdcm,!(s+o<l[f]+l[f+1])){t[f+1]=t[f+1]-1;break}l[f]=s,l[f+1]=o,e[f]=r,e[f+1]=i,c=!0}for(let f=u-1;f>0;f--)for(;t[f]!==t[f-1]+1;){t[f]=t[f]-1;const u=h(f-1,t,n,a);r=u.sbMean,s=u.sbSdcm;const m=h(f,t,n,a);if(i=m.sbMean,o=m.sbSdcm,!(s+o<l[f-1]+l[f])){t[f]=t[f]+1;break}l[f-1]=s,l[f]=o,e[f-1]=r,e[f]=i,c=!0}}return c}(u.mean,u.sdcm,a,e,l,t)&&(u=o(a,e,l,t)),a}function o(e,l,t,n){let a=[],u=[],s=[],o=0;const r=[],i=[];for(let b=0;b<n;b++){const n=h(b,e,l,t);r.push(n.sbMean),i.push(n.sbSdcm),o+=i[b]}let c,f=o,m=!0;for(;m||o<f;){m=!1,a=[];for(let l=0;l<n;l++)a.push(e[l]);for(let t=0;t<n;t++)for(let a=e[t]+1;a<=e[t+1];a++)if(c=l[a],t>0&&a!==e[t+1]&&Math.abs(c-r[t])>Math.abs(c-r[t-1]))e[t]=a;else if(t<n-1&&e[t]!==a-1&&Math.abs(c-r[t])>Math.abs(c-r[t+1])){e[t+1]=a-1;break}f=o,o=0,u=[],s=[];for(let a=0;a<n;a++){u.push(r[a]),s.push(i[a]);const n=h(a,e,l,t);r[a]=n.sbMean,i[a]=n.sbSdcm,o+=i[a]}}if(o>f){for(let l=0;l<n;l++)e[l]=a[l],r[l]=u[l],i[l]=s[l];o=f}return{mean:r,sdcm:i}}function h(e,l,t,n){let a=0,u=0;for(let r=l[e]+1;r<=l[e+1];r++){const e=n[r];a+=t[r]*e,u+=e}u<=0&&console.log("Exception in Natural Breaks calculation");const s=a/u;let o=0;for(let r=l[e]+1;r<=l[e+1];r++)o+=n[r]*(t[r]-s)**2;return{sbMean:s,sbSdcm:o}}__webpack_require__.d(__webpack_exports__,"a",(function(){return t}))},"./node_modules/@arcgis/core/statistics/utils.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return y})),__webpack_require__.d(__webpack_exports__,"b",(function(){return z})),__webpack_require__.d(__webpack_exports__,"c",(function(){return d})),__webpack_require__.d(__webpack_exports__,"d",(function(){return c})),__webpack_require__.d(__webpack_exports__,"e",(function(){return m})),__webpack_require__.d(__webpack_exports__,"f",(function(){return g})),__webpack_require__.d(__webpack_exports__,"g",(function(){return h})),__webpack_require__.d(__webpack_exports__,"h",(function(){return f})),__webpack_require__.d(__webpack_exports__,"i",(function(){return T})),__webpack_require__.d(__webpack_exports__,"j",(function(){return s})),__webpack_require__.d(__webpack_exports__,"k",(function(){return V})),__webpack_require__.d(__webpack_exports__,"l",(function(){return D}));var _rest_support_ClassBreaksDefinition_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/rest/support/ClassBreaksDefinition.js"),_rest_support_generateRendererUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/rest/support/generateRendererUtils.js");const r=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,o=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),u=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function s(e){const n=null!=e.normalizationField||null!=e.normalizationType,t=null!=e.minValue||null!=e.maxValue,l=!!e.sqlExpression&&e.supportsSQLExpression;return!n&&!t&&!l}function m(e){const n=e.returnDistinct?[...new Set(e.values)]:e.values,t=n.filter((e=>null!=e)).length,l={count:t};return e.supportsNullCount&&(l.nullcount=n.length-t),e.percentileParams&&(l.median=d(n,e.percentileParams)),l}function c(e){const{values:n,useSampleStdDev:t,supportsNullCount:l}=e;let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,r=null,o=null,u=null,s=null,m=0;const c=null==e.minValue?-1/0:e.minValue,f=null==e.maxValue?1/0:e.maxValue;for(const d of n)Number.isFinite(d)?d>=c&&d<=f&&(r+=d,i=Math.min(i,d),a=Math.max(a,d),m++):"string"==typeof d&&m++;if(m&&null!=r){o=r/m;let e=0;for(const t of n)Number.isFinite(t)&&t>=c&&t<=f&&(e+=(t-o)**2);s=t?m>1?e/(m-1):0:m>0?e/m:0,u=Math.sqrt(s)}else i=null,a=null;const p={avg:o,count:m,max:a,min:i,stddev:u,sum:r,variance:s};return l&&(p.nullcount=n.length-m),e.percentileParams&&(p.median=d(n,e.percentileParams)),p}function d(e,n){const{fieldType:t,value:l,orderBy:i,isDiscrete:a}=n,r=f(t,"desc"===i);if(0===(e=[...e].filter((e=>null!=e)).sort(((e,n)=>r(e,n)))).length)return null;if(l<=0)return e[0];if(l>=1)return e[e.length-1];const o=(e.length-1)*l,u=Math.floor(o),s=u+1,m=o%1,c=e[u],d=e[s];return s>=e.length||a||"string"==typeof c||"string"==typeof d?c:c*(1-m)+d*m}function f(e,n){const t=n?1:-1,l=function v(e){return e?(e,n)=>n-e:(e,n)=>e-n}(n),i=p(n);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...o].includes(e))return(e,n)=>"number"==typeof e&&"number"==typeof n?l(e,n):"string"==typeof e&&"string"==typeof n?i(e,n):t;if("esriFieldTypeDate"===e)return(e,n)=>{const i=new Date(e).getTime(),a=new Date(n).getTime();return isNaN(i)||isNaN(a)?t:l(i,a)};if(o.has(e))return(e,n)=>l(e,n);if("esriFieldTypeString"===e)return(e,n)=>i(e,n);if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){const e=p(n);return(n,t)=>e(b(n),b(t))}return n?(e,n)=>1:(e,n)=>-1}function p(e){return e?(e,n)=>(e=e.toUpperCase())>(n=n.toUpperCase())?-1:e<n?1:0:(e,n)=>(e=e.toUpperCase())<(n=n.toUpperCase())?-1:e>n?1:0}function b(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function V(e,n){let t;for(t in e)u.indexOf(t)>-1&&(Number.isFinite(e[t])||(e[t]=null));return n?(["avg","stddev","variance"].forEach((n=>{null!=e[n]&&(e[n]=Math.ceil(e[n]))})),e):e}function g(e){const n={};for(let t of e)(null==t||"string"==typeof t&&""===t.trim())&&(t=null),null==n[t]?n[t]={count:1,data:t}:n[t].count++;return{count:n}}function h(e,n,t){const l=e.count,i=[];t&&n&&"coded-value"===n.type&&n.codedValues.forEach((e=>{const n=e.code;l.hasOwnProperty(n)||(l[n]={data:n,count:0})}));for(const a in l){const e=l[a];i.push({value:e.data,count:e.count,label:e.label})}return{uniqueValueInfos:i}}function T(e,n,t,l){let i=null;switch(n){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(l)&&0!==l&&(i=e/l*100);break;case"field":Number.isFinite(t)&&0!==t&&(i=e/t);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=e**.5)}return i}function y(e,t){const l=F({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return e=function x(e,n,t){return n=null==n?-1/0:n,t=null==t?1/0:t,e.filter((e=>Number.isFinite(e)&&e>=n&&e<=t))}(e,t.minValue,t.maxValue),Object(_rest_support_generateRendererUtils_js__WEBPACK_IMPORTED_MODULE_1__.a)({definition:l,values:e,normalizationTotal:t.normalizationTotal})}function F(n){const i=n.field,a=n.classificationMethod||"equal-interval",r=n.normalizationType,o=n.normalizationField,u=new _rest_support_ClassBreaksDefinition_js__WEBPACK_IMPORTED_MODULE_0__.a;return u.classificationField=i,u.breakCount=n.breakCount,u.classificationMethod=a,u.standardDeviationInterval="standard-deviation"===a?n.standardDeviationInterval||1:void 0,u.normalizationType=r,u.normalizationField="field"===r?o:void 0,u}function D(e,n){let t=e.classBreaks;const l=t.length,i=t[0].minValue,a=t[l-1].maxValue,o="standard-deviation"===n,u=r;return t=t.map((e=>{const n=e.label,t={minValue:e.minValue,maxValue:e.maxValue,label:n};if(o&&n){const e=n.match(u).map((e=>+e.trim()));2===e.length?(t.minStdDev=e[0],t.maxStdDev=e[1],e[0]<0&&e[1]>0&&(t.hasAvg=!0)):1===e.length&&(n.includes("<")?(t.minStdDev=null,t.maxStdDev=e[0]):n.includes(">")&&(t.minStdDev=e[0],t.maxStdDev=null))}return t})),{minValue:i,maxValue:a,classBreakInfos:t,normalizationTotal:e.normalizationTotal}}function z(e,n){const{min:t,max:l,intervals:i}=I(e,n),a=i.map(((e,n)=>({minValue:i[n][0],maxValue:i[n][1],count:0})));for(const r of e)if(null!=r&&r>=t&&r<=l){const e=N(i,r);e>-1&&a[e].count++}return{bins:a,minValue:t,maxValue:l,normalizationTotal:n.normalizationTotal}}function I(e,n){const{field:t,classificationMethod:l,standardDeviationInterval:i,normalizationType:r,normalizationField:o,normalizationTotal:u,minValue:m,maxValue:d}=n,f=n.numBins||10;let p=null,v=null,b=null;if(l&&"equal-interval"!==l||r){const{classBreaks:n}=y(e,{field:t,normalizationType:r,normalizationField:o,normalizationTotal:u,classificationMethod:l,standardDeviationInterval:i,minValue:m,maxValue:d,numClasses:f});p=n[0].minValue,v=n[n.length-1].maxValue,b=n.map((e=>[e.minValue,e.maxValue]))}else{if(null!=m&&null!=d)p=m,v=d;else{const n=c({values:e,minValue:m,maxValue:d,useSampleStdDev:!r,supportsNullCount:s({normalizationType:r,normalizationField:o,minValue:m,maxValue:d})});p=n.min,v=n.max}b=function S(e,n,t){const l=(n-e)/t,i=[];let a,r=e;for(let o=1;o<=t;o++)a=r+l,a=Number(a.toFixed(16)),i.push([r,o===t?n:a]),r=a;return i}(p,v,f)}return{min:p,max:v,intervals:b}}function N(e,n){let t=-1;for(let l=e.length-1;l>=0;l--)if(n>=e[l][0]){t=l;break}return t}}}]);