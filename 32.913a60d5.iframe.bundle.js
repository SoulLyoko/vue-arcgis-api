(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"./node_modules/@arcgis/core/views/3d/analysis/AnalysisView3D.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return p}));var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_core_Promise_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Promise.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));const p=p=>{let i=class extends(Object(_core_Promise_js__WEBPACK_IMPORTED_MODULE_2__.b)(p)){constructor(){super(...arguments),this.parent=null}get updating(){return!1}get visible(){const r=!Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.l)(this.parent)||this.parent.visible&&!this.parent.suspended;return this.analysis.visible&&r}};return Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.b)({readOnly:!0})],i.prototype,"type",void 0),Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.b)({constructOnly:!0})],i.prototype,"analysis",void 0),Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.b)({constructOnly:!0})],i.prototype,"parent",void 0),Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.b)({constructOnly:!0})],i.prototype,"view",void 0),Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.b)({readOnly:!0})],i.prototype,"updating",null),Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.b)({readOnly:!0})],i.prototype,"visible",null),i=Object(_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__.a)([Object(_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.a)("esri.views.3d.analysis.AnalysisView3D")],i),i}},"./node_modules/@arcgis/core/views/3d/analysis/LineOfSight/LineOfSightView3D.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return LineOfSightView3D_m}));var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),HandleOwner=__webpack_require__("./node_modules/@arcgis/core/core/HandleOwner.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),AnalysisView3D=__webpack_require__("./node_modules/@arcgis/core/views/3d/analysis/AnalysisView3D.js"),Handles=(__webpack_require__("./node_modules/@arcgis/core/geometry.js"),__webpack_require__("./node_modules/@arcgis/core/core/Handles.js")),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),vec3=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3f64.js"),projection=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),ray=__webpack_require__("./node_modules/@arcgis/core/geometry/support/ray.js");let LineOfSightAnalysis_i=class extends Accessor.a{constructor(t){super(t),this.elevationAlignedTargetLocation=null,this.inputPoints={isValid:!1,observer:Object(vec3f64.f)(),observerSurfaceNormal:null,target:Object(vec3f64.f)(),targetSurfaceNormal:null,observerAdjusted:Object(vec3f64.f)(),targetAdjusted:Object(vec3f64.f)()},this.computationResult={start:Object(vec3f64.f)(),end:Object(vec3f64.f)(),intersection:Object(vec3f64.f)(),isValid:!1,isTargetVisible:!1},this.result=null}updateComputationResults(){this.notifyChange("computationResult")}updateInputPoints(){this.notifyChange("inputPoints")}onElevationChange(){this.notifyChange("elevationAlignedTargetLocation")}};Object(tslib_es6.a)([Object(property.b)()],LineOfSightAnalysis_i.prototype,"target",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightAnalysis_i.prototype,"elevationAlignedTargetLocation",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightAnalysis_i.prototype,"inputPoints",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightAnalysis_i.prototype,"computationResult",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightAnalysis_i.prototype,"result",void 0),LineOfSightAnalysis_i=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightAnalysis")],LineOfSightAnalysis_i);var LineOfSightIntersectionResult_n,screenUtils=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),vectorStacks=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js"),dehydratedFeatures=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedFeatures.js"),lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js");let LineOfSightIntersectionResult_a=LineOfSightIntersectionResult_n=class extends Accessor.a{constructor(r){super(r)}clone(){return new LineOfSightIntersectionResult_n({type:this.type,id:Object(lang.a)(this.id),point:Object(lang.a)(this.point),normal:Object(lang.a)(this.normal),ray:Object(lang.a)(this.ray)})}equals(r){return this.type===r.type&&this.id===r.id&&Object(maybe.g)(this.point,r.point)&&Object(arrayUtils.e)(this.normal,r.normal)&&Object(ray.e)(this.ray,r.ray)}};Object(tslib_es6.a)([Object(property.b)()],LineOfSightIntersectionResult_a.prototype,"type",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightIntersectionResult_a.prototype,"id",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightIntersectionResult_a.prototype,"point",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightIntersectionResult_a.prototype,"normal",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightIntersectionResult_a.prototype,"ray",void 0),LineOfSightIntersectionResult_a=LineOfSightIntersectionResult_n=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightIntersectionResult")],LineOfSightIntersectionResult_a);var Intersector=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/i3s/Intersector.js"),geometryUtils_ray=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/geometryUtils/ray.js"),terrain_Intersector=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/Intersector.js"),tileUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/tileUtils.js"),lib_Intersector=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Intersector.js"),intersectorUtilsConversions=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/intersectorUtilsConversions.js");let S=class extends Accessor.a{constructor(e){super(e)}initialize(){this.intersector=Object(lib_Intersector.b)(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=0}getScreenPointIntersection(e){const t=Object(screenUtils.i)(e,vectorStacks.c.get()),r=Object(geometryUtils_ray.c)(this.view.state.camera,t,F);return this._getRayIntersection(r)}_getRayIntersection(e){if(Object(maybe.k)(e))return null;this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this.intersector);const t=this.intersector.results.min;if(!t.getIntersectionPoint(C))return null;const o=this.view.renderCoordsHelper.fromRenderCoords(C,this.view.spatialReference),i=Object(vec3f64.g)(t.normal),n=Object(vec3.j)(i,e.direction)>0?-1:1;if(Object(vec3.g)(i,i,n),Object(Intersector.a)(t))return new LineOfSightIntersectionResult_a({type:0,id:`${t.target.layerUid}/${t.target.nodeIndex}/${t.target.componentIndex}`,point:o,normal:i,ray:Object(ray.b)(e)});if(Object(terrain_Intersector.b)(t))return new LineOfSightIntersectionResult_a({type:2,id:t.target.lij.slice(),point:o,normal:i,ray:Object(ray.b)(e)});const p=Object(intersectorUtilsConversions.a)(t,this.view);if(Object(maybe.l)(p)){const t=p.layer,r=p.sourceLayer;let s;return s=r&&"scene"===r.type?Object(dehydratedFeatures.g)(p,r.objectIdField):p.uid,new LineOfSightIntersectionResult_a({type:0,id:`${t.uid}/${s}`,point:o,normal:i,ray:Object(ray.b)(e)})}return null}_canUpdateFromIntersectionResult(e,t){if(Object(maybe.k)(e)||!t||e.type!==t.type)return!1;switch(e.type){case 2:{const r=e.id,s=t.id;return r[0]===s[0]&&r[1]===s[1]&&r[2]===s[2]||Object(tileUtils.i)(r,s)}case 0:case 4:return e.id===t.id}}updateFromIntersectionResult(e){let t;if(2===e.type&&Object(maybe.l)(e.point)){const r=C,s=LineOfSightRayIntersector_,o=x;this.view.renderCoordsHelper.toRenderCoords(e.point,s),this.view.renderCoordsHelper.worldUpAtPosition(s,o);const i=this.view.basemapTerrain.elevationBounds,n=this.view.renderCoordsHelper.getAltitude(s),c=i?Math.abs(i.max-i.min)/Math.abs(n):100,l=n>0?1:-1;Object(vec3.t)(o,o),Object(vec3.g)(o,o,l*c),Object(vec3.h)(r,s,o),Object(ray.f)(r,s,F),t=this._getRayIntersection(F)}else t=this._getRayIntersection(e.ray);return this._canUpdateFromIntersectionResult(t,e)?t.point:null}};Object(tslib_es6.a)([Object(property.b)()],S.prototype,"view",void 0),Object(tslib_es6.a)([Object(property.b)()],S.prototype,"intersector",void 0),S=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightRayIntersector")],S);const C=Object(vec3f64.f)(),LineOfSightRayIntersector_=Object(vec3f64.f)(),x=Object(vec3f64.f)(),F=Object(ray.c)();let LineOfSightResult_s=class extends Accessor.a{constructor(o){super(o),this.target=null,this.intersectedGraphic=null,this.intersectedLocation=null,this.elevationAlignedTargetLocation=null}};Object(tslib_es6.a)([Object(property.b)()],LineOfSightResult_s.prototype,"target",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightResult_s.prototype,"intersectedGraphic",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightResult_s.prototype,"intersectedLocation",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightResult_s.prototype,"elevationAlignedTargetLocation",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightResult_s.prototype,"visible",void 0),LineOfSightResult_s=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightResult")],LineOfSightResult_s);var ElevationProvider=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/ElevationProvider.js"),Scheduler=__webpack_require__("./node_modules/@arcgis/core/views/support/Scheduler.js"),WatchUpdatingTracking=__webpack_require__("./node_modules/@arcgis/core/views/support/WatchUpdatingTracking.js"),Point=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js");let M=class extends(Evented.a.EventedMixin(Accessor.a)){constructor(e){super(e),this._updatingHandles=new WatchUpdatingTracking.a,this._frameTask=Scheduler.a,this._handles=new Handles.a,this._analysisHandles=new Handles.a}initialize(){var e;const t=null==(e=this.view.resourceController)?void 0:e.scheduler;t&&(this._frameTask=t.registerTask(Scheduler.b.LINE_OF_SIGHT_TOOL)),this._handles.add([this._connectObserver(),this._connectAnalyses(),this._connectTargets()]),this._intersector=new S({view:this.view})}destroy(){this._handles.destroy(),this._analysisHandles.destroy(),this._analyses.removeAll(),this._updatingHandles.destroy()}get updating(){return this._frameTask.updating||this._updatingHandles.updating}get priority(){return this._frameTask.priority}set priority(e){this._frameTask.priority=e}get _analyses(){return this.analysisViewData.analyses}get _observerEngineLocation(){return this.analysisViewData.observerEngineLocation}set _observerEngineLocation(e){this.analysisViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._observerEngineLocation)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return{inputPoints:t}}computeAnalysis(e){const t=e.analysis,{inputPoints:s,computationResult:n}=t,{observerAdjusted:i,targetAdjusted:r}=s,{start:o,end:a}=n;Object(vec3.m)(o,i),Object(vec3.m)(a,r),this._canComputeAnalysis(t)?this._computeAnalysisIntersection(e):this._interpolateAnalysisIntersection(e),t.updateComputationResults(),this.emit("result-changed",{target:e.analysis.target,result:t.result})}_adjustStartEndPositions(e){const t=this._screenPixelSize,s=this.view,{inputPoints:n}=e,{observer:i,observerSurfaceNormal:r,target:a,targetSurfaceNormal:l,observerAdjusted:c,targetAdjusted:h}=n,p=Z;Object(maybe.l)(r)?Object(vec3.m)(p,r):Object(vec3.l)(p,a,i);const d=t;Object(vec3.t)(p,p),Object(vec3.g)(p,p,Math.min(d,1)),Object(vec3.h)(c,i,p),Object(maybe.l)(l)?Object(vec3.m)(p,l):Object(vec3.l)(p,i,a);const u=s.state.camera.computeScreenPixelSizeAt(a);Object(vec3.t)(p,p),Object(vec3.g)(p,p,Math.min(u,1)),Object(vec3.h)(h,a,p)}_computeAnalysisIntersection({analysis:e,interpolationInfo:t}){const{view:s}=this,{sceneIntersectionHelper:n,renderCoordsHelper:i}=s;if(Object(maybe.k)(n))return;const r=this._intersector.intersector,{computationResult:l,inputPoints:c}=e,{observer:h,target:p}=c,{start:d,end:u}=l,g=Object(ray.f)(d,u,J);n.intersectToolIntersectorRay(g,r);const y=l.intersection,_=Z,m=r.results.min.getIntersectionPoint(y);let v=!0;if(m){Object(vec3.m)(t.originalIntersection,y),Object(vec3.m)(t.originalObserver,d),Object(vec3.m)(t.originalTarget,u),i.fromRenderCoords(y,_,s.spatialReference);const e=1-Object(vec3.p)(u,p)/Object(vec3.p)(d,p);v=Object(vec3.p)(h,y)>=e*Object(vec3.p)(h,p)}const f=new Point.a(_,s.spatialReference);{const{result:t,target:n}=e;Object(maybe.l)(t)?(t.target=n,t.intersectedGraphic=v?null:Object(intersectorUtilsConversions.a)(r.results.min,s),t.intersectedLocation=v?null:f,t.visible=!!m&&v):e.result=new LineOfSightResult_s({target:n,elevationAlignedTargetLocation:e.elevationAlignedTargetLocation,intersectedGraphic:v?null:Object(intersectorUtilsConversions.a)(r.results.min,s),intersectedLocation:v?null:f,visible:!!m&&v})}l.isValid=c.isValid=!0,l.isTargetVisible=v}_interpolateAnalysisIntersection({analysis:e,interpolationInfo:t}){const{computationResult:s,inputPoints:n}=e,{start:i,end:r,intersection:o}=s,{originalIntersection:a,originalObserver:l,originalTarget:c}=t;if(Object(vec3.m)(o,a),n.isValid){const e=Z,t=Object(vec3.p)(l,a)/Object(vec3.p)(l,c);Object(vec3.B)(e,i,l),Object(vec3.g)(e,e,1-t),Object(vec3.h)(o,o,e),Object(vec3.B)(e,r,c),Object(vec3.g)(e,e,t),Object(vec3.h)(o,o,e),s.isValid=!0}else e.result=null,s.isValid=!1,s.isTargetVisible=!1}_canComputeAnalysis(e){const t=this.analysisViewData.elevationAlignedObserver,s=this.view.frustum;if(Object(maybe.k)(t)||Object(maybe.k)(e.target)||Object(maybe.k)(s))return!1;const{observerAdjusted:n,targetAdjusted:i}=e.inputPoints,r=s.intersectsPoint(n),o=s.intersectsPoint(i);return r&&o}_onObserverChange(e,t){if(Object(maybe.k)(e))return this.analysis.targets.removeAll(),void(this.analysisViewData.elevationAlignedObserver=null);this.analysisViewData.elevationAlignedObserver=this._applyElevationAlignment(e,t);const s=Object(vec3f64.f)();this.view.renderCoordsHelper.toRenderCoords(this.analysisViewData.elevationAlignedObserver,s),this._observerEngineLocation=s,this.priority=Scheduler.b.LINE_OF_SIGHT_TOOL_INTERACTIVE}_applyElevationAlignment(e,t){if(e.hasZ&&(Object(maybe.k)(t)||0===t.type))return e;const s=e.clone();return s.z=Object(maybe.v)(Object(ElevationProvider.b)(this.view.elevationProvider,s),0),s}_onObserverChangeForAnalysis(e){e.inputPoints.isValid=!1}_onObserverEngineForAnalysis(e,t,s){const{inputPoints:n}=e;if(Object(vec3.m)(n.observer,t),Object(maybe.l)(s)){const e=this._intersector.updateFromIntersectionResult(s);Object(maybe.l)(e)&&this.view.renderCoordsHelper.toRenderCoords(e,n.observer),n.observerSurfaceNormal=Object(vec3f64.d)(s.normal)}else n.observerSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=Scheduler.b.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetLocationChange(e,t,s){const n=e.inputPoints;if(n.isValid=!1,Object(maybe.l)(t)){if(e.elevationAlignedTargetLocation=this._applyElevationAlignment(t,s),this.view.renderCoordsHelper.toRenderCoords(e.elevationAlignedTargetLocation,n.target),Object(maybe.l)(s)){const e=this._intersector.updateFromIntersectionResult(s);Object(maybe.l)(e)&&this.view.renderCoordsHelper.toRenderCoords(e,n.target),n.targetSurfaceNormal=Object(vec3f64.d)(s.normal)}else n.targetSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints()}this.priority=Scheduler.b.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectAnalysisToTarget(e){return Object(handleUtils.a)([Object(reactiveUtils.b)((()=>e.target.location),(t=>{B(t,e.target.intersection)||(e.target.intersection=null)}),reactiveUtils.a),Object(reactiveUtils.b)((()=>({analysis:e,targetLocation:e.target.location,targetIntersection:e.target.intersection})),(({analysis:e,targetLocation:t,targetIntersection:s})=>{Object(maybe.l)(t)&&this._onTargetLocationChange(e,t,s)}),reactiveUtils.e)])}_connectAnalysisToObserver(e){return Object(reactiveUtils.b)((()=>({analysis:e,observer:this.analysisViewData.elevationAlignedObserver})),(({analysis:e})=>{this._onObserverChangeForAnalysis(e)}),reactiveUtils.e)}_connectAnalysisToObserverEngine(e){return Object(reactiveUtils.b)((()=>({analysis:e,observer:this._observerEngineLocation,observerIntersection:this.analysis.intersection})),(({analysis:e,observer:t,observerIntersection:s})=>{this._onObserverEngineForAnalysis(e,t,s)}),reactiveUtils.e)}_connectAnalysisToCamera(e){return Object(reactiveUtils.b)((()=>({camera:this.view.state.camera,isDirty:this._isCameraDirty})),(({isDirty:t})=>{e.inputPoints.isValid&&!t||e.updateInputPoints()}),reactiveUtils.d)}_connectAnalysisToElevation(e){return this.view.elevationProvider.on("elevation-change",(t=>{if(!this._canComputeAnalysis(e))return;const s=this.analysis.observer;q(t.extent,t.spatialReference,s)&&this._onObserverChange(s,this.analysis.intersection);const n=e.target;Object(maybe.l)(n)&&q(t.extent,t.spatialReference,n.location)&&e.onElevationChange()}))}_connectAnalysisForCompute(e){let t=maybe.q;const s={analysis:e,interpolationInfo:{originalIntersection:Object(vec3f64.f)(),originalObserver:Object(vec3f64.f)(),originalTarget:Object(vec3f64.f)()}};return Object(handleUtils.a)([Object(reactiveUtils.b)((()=>this.getLineOfSightComputationDependencies(e)),(()=>{t=Object(maybe.a)(t),t=Object(promiseUtils.h)((async e=>{await Object(promiseUtils.l)(this._frameTask.schedule((()=>this.computeAnalysis(s)),e))}))}),reactiveUtils.e),Object(handleUtils.b)((()=>t=Object(maybe.a)(t)))])}_connectAnalysis(e){const t=this._analysisHandles;t.has(e)||t.add([this._connectAnalysisToTarget(e),this._connectAnalysisToObserver(e),this._connectAnalysisToObserverEngine(e),this._connectAnalysisToCamera(e),this._connectAnalysisToElevation(e),this._connectAnalysisForCompute(e)],e)}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}_onTargetsChange(){return this._analyses.removeAll(),this.analysis.targets.forEach((e=>this._addTarget(e))),this._updatingHandles.addOnCollectionPropertyChange(this.analysis,"targets",(e=>this._onTargetCollectionChange(e)))}_onTargetCollectionChange(e){e.added.forEach((e=>this._addTarget(e))),e.removed.forEach((e=>this._removeTarget(e)))}_onCursorTargetChange(e,t){Object(maybe.l)(t)&&this._removeTarget(t),Object(maybe.l)(e)&&this._addTarget(e)}_addTarget(e){this._analyses.some((t=>t.target===e))||this._analyses.add(new LineOfSightAnalysis_i({target:e}))}_removeTarget(e){const t=this._analyses.find((t=>t.target===e));this._analyses.remove(t)}_connectObserver(){return Object(handleUtils.a)([Object(reactiveUtils.b)((()=>this.analysis.observer),(e=>{B(e,this.analysis.intersection)||(this.analysis.intersection=null)}),reactiveUtils.a),Object(reactiveUtils.b)((()=>({observer:this.analysis.observer,intersection:this.analysis.intersection})),(({observer:e,intersection:t})=>this._onObserverChange(e,t)),reactiveUtils.e)])}_connectAnalyses(){let e=null;return Object(handleUtils.a)([Object(reactiveUtils.b)((()=>this._analyses),(()=>{Object(maybe.t)(e),e=this._updatingHandles.addOnCollectionPropertyChange(this,"_analyses",(e=>this._onAnalysesCollectionChange(e))),this._analyses.forEach((e=>this._connectAnalysis(e)))}),reactiveUtils.e),Object(handleUtils.b)((()=>e=Object(maybe.t)(e)))])}_connectTargets(){let e=null;return Object(handleUtils.a)([Object(reactiveUtils.b)((()=>this.analysis.targets),(()=>{e=Object(maybe.t)(e),e=this._onTargetsChange()}),reactiveUtils.e),Object(reactiveUtils.b)((()=>this.analysisViewData.cursorTarget),((e,t)=>{this._onCursorTargetChange(e,t)})),Object(handleUtils.b)((()=>{e=Object(maybe.t)(e)}))])}get _isCameraDirty(){const e=this.analysisViewData.elevationAlignedObserver,{view:t}=this,{renderCoordsHelper:s}=t;if(Object(maybe.k)(e)||Object(maybe.k)(s))return!1;const n=Z;s.toRenderCoords(e,n);const i=t.state.camera.computeScreenPixelSizeAt(n);return Math.abs((i-this._screenPixelSize)/this._screenPixelSize)>W}};function q(e,t,s){return!Object(maybe.k)(s)&&(Object(projection.n)(e,t,K,s.spatialReference),Object(aaBoundingRect.i)(K,s))}function B(e,t){return Object(maybe.k)(t)||Object(maybe.l)(e)&&e.equals(t.point)}Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],M.prototype,"analysis",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],M.prototype,"analysisViewData",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],M.prototype,"view",void 0),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"updating",null),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"priority",null),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"_analyses",null),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"_observerEngineLocation",null),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"_screenPixelSize",null),Object(tslib_es6.a)([Object(property.b)({readOnly:!0})],M.prototype,"_updatingHandles",void 0),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"_frameTask",void 0),Object(tslib_es6.a)([Object(property.b)()],M.prototype,"_isCameraDirty",null),M=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightController")],M);const W=.1,Z=Object(vec3f64.f)(),J=Object(ray.c)(),K=Object(aaBoundingRect.n)();var Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),Color=__webpack_require__("./node_modules/@arcgis/core/Color.js");let LineOfSightConfiguration_s=class extends Accessor.a{constructor(o){super(o),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new Color.a([3,252,111,1]),this.visibleOuterColor=new Color.a([3,252,111,.15]),this.occludedInnerColor=new Color.a([252,3,69,1]),this.occludedOuterColor=new Color.a([252,3,69,.1]),this.undefinedInnerColor=new Color.a([255,255,255,1]),this.undefinedOuterColor=new Color.a([127,127,127,.2])}};Object(tslib_es6.a)([Object(property.b)({type:Number})],LineOfSightConfiguration_s.prototype,"innerWidth",void 0),Object(tslib_es6.a)([Object(property.b)({type:Number})],LineOfSightConfiguration_s.prototype,"outerWidth",void 0),Object(tslib_es6.a)([Object(property.b)({type:Color.a})],LineOfSightConfiguration_s.prototype,"visibleInnerColor",void 0),Object(tslib_es6.a)([Object(property.b)({type:Color.a})],LineOfSightConfiguration_s.prototype,"visibleOuterColor",void 0),Object(tslib_es6.a)([Object(property.b)({type:Color.a})],LineOfSightConfiguration_s.prototype,"occludedInnerColor",void 0),Object(tslib_es6.a)([Object(property.b)({type:Color.a})],LineOfSightConfiguration_s.prototype,"occludedOuterColor",void 0),Object(tslib_es6.a)([Object(property.b)({type:Color.a})],LineOfSightConfiguration_s.prototype,"undefinedInnerColor",void 0),Object(tslib_es6.a)([Object(property.b)({type:Color.a})],LineOfSightConfiguration_s.prototype,"undefinedOuterColor",void 0),LineOfSightConfiguration_s=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightConfiguration")],LineOfSightConfiguration_s);let LineOfSightViewData_n=class extends Accessor.a{constructor(){super(...arguments),this.analyses=new Collection.a,this.elevationAlignedObserver=null,this.configuration=new LineOfSightConfiguration_s,this.observerEngineLocation=Object(vec3f64.f)(),this.cursorTarget=null}};Object(tslib_es6.a)([Object(property.b)()],LineOfSightViewData_n.prototype,"analyses",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightViewData_n.prototype,"elevationAlignedObserver",void 0),Object(tslib_es6.a)([Object(property.b)({type:LineOfSightConfiguration_s})],LineOfSightViewData_n.prototype,"configuration",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightViewData_n.prototype,"observerEngineLocation",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightViewData_n.prototype,"cursorTarget",void 0),LineOfSightViewData_n=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightViewData")],LineOfSightViewData_n);var mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),mat4f64=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4f64.js"),LineVisualElement=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js");let LineOfSightVisualization_g=class extends Accessor.a{constructor(i){super(i),this._handle=null,this._analysisHandles=new Handles.a}initialize(){this._handle=this._connectAnalyses()}destroy(){this._handle=Object(maybe.t)(this._handle),this._analysisHandles=Object(maybe.e)(this._analysisHandles)}get visible(){return this.analysisView.visible&&!this.analysisView.suspended}get _analyses(){return this.analysisView.analysisViewData.analyses}get _configuration(){return this.analysisView.analysisViewData.configuration}get _opacity(){return this.analysisView.fullOpacity}createLineOfSightVisualization(){const i=this._configuration,t=this._opacity,n={view:this.view,attached:!0,width:i.outerWidth,innerWidth:i.innerWidth},o=Color.a.toUnitRGBA(i.visibleOuterColor);Object(mathUtils.c)(o,o,t);const s=Color.a.toUnitRGBA(i.visibleInnerColor);Object(mathUtils.c)(s,s,t);const r=Color.a.toUnitRGBA(i.occludedOuterColor);Object(mathUtils.c)(r,r,t);const a=Color.a.toUnitRGBA(i.occludedInnerColor);Object(mathUtils.c)(a,a,t);const c=Color.a.toUnitRGBA(i.undefinedOuterColor);Object(mathUtils.c)(c,c,t);const u=Color.a.toUnitRGBA(i.undefinedInnerColor);return Object(mathUtils.c)(u,u,t),{visibleLineVisualElement:new LineVisualElement.a({...n,color:o,innerColor:s}),occludedLineVisualElement:new LineVisualElement.a({...n,color:r,innerColor:a}),undefinedLineVisualElement:new LineVisualElement.a({...n,color:c,innerColor:u})}}destroyLineOfSightVisualization(i){i.visibleLineVisualElement=Object(maybe.e)(i.visibleLineVisualElement),i.occludedLineVisualElement=Object(maybe.e)(i.occludedLineVisualElement),i.undefinedLineVisualElement=Object(maybe.e)(i.undefinedLineVisualElement)}updateLineOfSightVisualization(i,t){const n=this.visible,o=this._configuration,{computationResult:s,inputPoints:r}=i,{start:a,end:c,intersection:u,isValid:d,isTargetVisible:m}=s,{observer:h}=r,p=L;p[12]=h[0],p[13]=h[1],p[14]=h[2];const v=Object(vec3.l)(LineOfSightVisualization_,a,h),V=Object(vec3.l)(b,c,h),g=Object(vec3.l)(LineOfSightVisualization_C,u,h),{visibleLineVisualElement:O,occludedLineVisualElement:A,undefinedLineVisualElement:E}=t;if(!n)return O.visible=!1,A.visible=!1,void(E.visible=!1);if(O.visible=!0,A.visible=!0,E.visible=!0,O.geometry=null,A.geometry=null,E.geometry=null,d)if(m){O.geometry=[[Object(vec3f64.g)(v),Object(vec3f64.g)(V)]],O.transform=p;const i=Color.a.toUnitRGBA(o.visibleOuterColor);O.color=Object(mathUtils.c)(i,i,this._opacity)}else{O.geometry=[[Object(vec3f64.g)(v),Object(vec3f64.g)(g)]],O.transform=p;const i=Color.a.toUnitRGBA(o.occludedOuterColor);O.color=Object(mathUtils.c)(i,i,this._opacity),A.geometry=[[Object(vec3f64.g)(g),Object(vec3f64.g)(V)]],A.transform=p}else E.geometry=[[Object(vec3f64.g)(v),Object(vec3f64.g)(V)]],E.transform=p}updateVisualizationOpacity(i,t){const n=this._configuration,o=this._opacity,s=Color.a.toUnitRGBA(n.visibleOuterColor);Object(mathUtils.c)(s,s,o);const r=Color.a.toUnitRGBA(n.visibleInnerColor);Object(mathUtils.c)(r,r,o);const a=Color.a.toUnitRGBA(n.occludedOuterColor);Object(mathUtils.c)(a,a,o);const c=Color.a.toUnitRGBA(n.occludedInnerColor);Object(mathUtils.c)(c,c,o);const u=Color.a.toUnitRGBA(n.undefinedOuterColor);Object(mathUtils.c)(u,u,o);const d=Color.a.toUnitRGBA(n.undefinedInnerColor);Object(mathUtils.c)(d,d,o),t.visibleLineVisualElement.color=i.computationResult.isTargetVisible?s:a,t.visibleLineVisualElement.innerColor=r,t.occludedLineVisualElement.color=a,t.occludedLineVisualElement.innerColor=c,t.undefinedLineVisualElement.color=u,t.undefinedLineVisualElement.innerColor=d}getLineOfSightVisualizationDependencies(i){const{computationResult:e}=i,{occludedOuterColor:t,visibleOuterColor:n}=this._configuration;return{computationResult:e,occludedOuterColor:t,visibleOuterColor:n,visible:this.visible}}_connectAnalysis(i){const e=this._analysisHandles;if(e.has(i))return;const t=this.createLineOfSightVisualization();e.add([Object(reactiveUtils.b)((()=>this.getLineOfSightVisualizationDependencies(i)),(()=>this.updateLineOfSightVisualization(i,t)),reactiveUtils.e),Object(reactiveUtils.b)((()=>this._opacity),(()=>this.updateVisualizationOpacity(i,t)),reactiveUtils.d),Object(handleUtils.b)((()=>this.destroyLineOfSightVisualization(t)))],i)}_disconnectAnalysis(i){this._analysisHandles.remove(i)}_connectAnalyses(){let i=null;return Object(handleUtils.a)([Object(reactiveUtils.b)((()=>this._analyses),(e=>{i=Object(maybe.t)(i),i=e.on("change",(i=>this._onAnalysesCollectionChange(i))),this._onAnalysesCollectionChange({target:e,added:e.items,removed:[],moved:[]})}),reactiveUtils.e),Object(handleUtils.b)((()=>i=Object(maybe.t)(i)))])}_onAnalysesCollectionChange(i){i.added.forEach((i=>this._connectAnalysis(i))),i.removed.forEach((i=>this._disconnectAnalysis(i)))}};Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightVisualization_g.prototype,"analysis",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightVisualization_g.prototype,"analysisView",void 0),Object(tslib_es6.a)([Object(property.b)({constructOnly:!0})],LineOfSightVisualization_g.prototype,"view",void 0),Object(tslib_es6.a)([Object(property.b)({readOnly:!0})],LineOfSightVisualization_g.prototype,"visible",null),Object(tslib_es6.a)([Object(property.b)()],LineOfSightVisualization_g.prototype,"_analyses",null),Object(tslib_es6.a)([Object(property.b)()],LineOfSightVisualization_g.prototype,"_configuration",null),Object(tslib_es6.a)([Object(property.b)()],LineOfSightVisualization_g.prototype,"_opacity",null),LineOfSightVisualization_g=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightVisualization")],LineOfSightVisualization_g);const LineOfSightVisualization_=Object(vec3f64.f)(),b=Object(vec3f64.f)(),LineOfSightVisualization_C=Object(vec3f64.f)(),L=Object(mat4f64.d)();let LineOfSightView3D_d=class extends(Object(AnalysisView3D.a)(Object(HandleOwner.b)(Evented.a.EventedMixin(Accessor.a)))){constructor(s){super(s),this.type="line-of-sight-view",this.suspended=!1,this.fullOpacity=1,this.analysisViewData=new LineOfSightViewData_n}initialize(){const s=this.view,t=this.analysis;this._analysisController=new M({analysis:t,analysisViewData:this.analysisViewData,view:s}),this._analysisVisualization=new LineOfSightVisualization_g({analysis:t,analysisView:this,view:s}),this.handles.add([this._analysisController.on("result-changed",(s=>{s.target!==this.analysisViewData.cursorTarget&&this.emit("result-changed",s)}))])}destroy(){this._analysisController=Object(maybe.e)(this._analysisController),this._analysisVisualization=Object(maybe.e)(this._analysisVisualization)}get results(){return this.analysisViewData.analyses.map((s=>s.result))}get priority(){return this._analysisController.priority}set priority(s){this._analysisController.priority=s}get updating(){return Object(maybe.l)(this._analysisController)&&this._analysisController.updating}getResultForTarget(s){const t=this.analysisViewData.analyses.find((t=>t.target===s)),i=Object(maybe.c)(t,(s=>s.result));return Object(maybe.v)(i,null)}get test(){return{visualization:this._analysisVisualization,controller:this._analysisController}}};Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"type",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"analysis",void 0),Object(tslib_es6.a)([Object(property.b)({readOnly:!0})],LineOfSightView3D_d.prototype,"results",null),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"priority",null),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"suspended",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"fullOpacity",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"analysisViewData",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"updating",null),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"_analysisController",void 0),Object(tslib_es6.a)([Object(property.b)()],LineOfSightView3D_d.prototype,"_analysisVisualization",void 0),LineOfSightView3D_d=Object(tslib_es6.a)([Object(subclass.a)("esri.views.3d.analysis.LineOfSight.LineOfSightView3D")],LineOfSightView3D_d);const LineOfSightView3D_m=LineOfSightView3D_d},"./node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return m}));var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4.js"),_chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4f64.js"),_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3f64.js"),_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4.js"),_chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4f32.js"),_Object3DVisualElement_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js"),_layers_graphics_lineUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/lineUtils.js"),_webgl_engine_materials_RibbonLineMaterial_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/RibbonLineMaterial.js");class m extends _Object3DVisualElement_js__WEBPACK_IMPORTED_MODULE_7__.a{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=Object(_chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__.c)(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}setGeometryFromExtent(e){const t=this.view.spatialReference,r=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.f)(),s=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.f)(),i=100,n=[];Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.y)(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.y)(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.y)(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.y)(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.y)(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.y)(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.f)(),h=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.f)(),a=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.f)(),p=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.f)();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,h[0]=r[0]-s[0]*o+i[0]*o,h[1]=r[1]-s[1]*o+i[1]*o,h[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([h[0],h[1],h[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.i)(g),Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.a)(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c){Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.i)(g),Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.a)(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.g)(e,this._color)||(Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(r)?!Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(this._innerColor)&&Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.g)(r,this._innerColor)||(this._innerColor=Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.c)(Object(_chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__.b)(),r),this._updateMaterial()):Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(t)!==Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(r)||Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(this._stippleOffColor)||!Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.g)(r,this._stippleOffColor))&&(this._stippleOffColor=Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(r)?Object(_chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__.a)(r):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){this._stipplePreferContinuous!==e&&(this._stipplePreferContinuous=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new _webgl_engine_materials_RibbonLineMaterial_js__WEBPACK_IMPORTED_MODULE_9__.a(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=Object(_layers_graphics_lineUtils_js__WEBPACK_IMPORTED_MODULE_8__.a)(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameters(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={overlayInfo:null,attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=Object(_chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__.d)()},"./node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return c}));var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4.js"),_chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4f64.js"),_VisualElement_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js"),_webgl_engine_lib_Object3D_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3D.js"),_webgl_engine_lib_WebGLLayer_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/WebGLLayer.js");class c extends _VisualElement_js__WEBPACK_IMPORTED_MODULE_3__.a{constructor(e){super(e.view),this._resources=null,this._transform=Object(_chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__.d)()}get object(){return Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.c)(this._transform,s),Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.l)(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new _webgl_engine_lib_WebGLLayer_js__WEBPACK_IMPORTED_MODULE_5__.a({isPickable:!1,updatePolicy:1});e.add(s);const r=new _webgl_engine_lib_Object3D_js__WEBPACK_IMPORTED_MODULE_4__.a({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.k)(this._resources)||this._resources.object.setVisible(e)}}},"./node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return t}));class t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch("ready",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?"attached"===s?e=t[s]:this[s]=t[s]:console.error("Cannot set unknown property",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}}}]);